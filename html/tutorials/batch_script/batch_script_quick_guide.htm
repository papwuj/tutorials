<!DOCTYPE html>
<html lang="en-US">
<head>
<title>Batch Script - Quick Guide</title>
<meta charset="utf-8">
<meta name="description" content="Batch Script - Quick Guide - Batch Script is incorporated to automate command sequences which are repetitive in nature. Scripting is a way by which one can alleviate this necessity by autom"/>
<meta name="keywords" content="C, C++, Python, Java, HTML, CSS, JavaScript, SQL, PHP, jQuery, XML, DOM, Bootstrap, Tutorials, Articles, Programming, training, learning, quiz, preferences, examples, code"/>
<link rel="canonical" href="https://www.tutorialspoint.com/batch_script/batch_script_quick_guide.htm" />
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
<meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=yes">
<script src="/theme/js/script-min-v2.js?v=3"></script>
<link rel="stylesheet" href="/theme/css/style-min-v2.css?v=6">
<script src="//services.bilsyndication.com/adv1/?d=901" defer="" async=""></script>
<script> var vitag = vitag || {};</script>
<script> vitag.outStreamConfig = { enablePC: false, enableMobile: false };</script>  
<style>
.right-menu .mui-btn {
    background-color:#17c06a;
}
a.demo {
    background:#17c06a;
}
li.heading {
    background:#17c06a;
}
.course-box{background:#17c06a}
.home-intro-sub p{color:#17c06a}
</style>
</head>
<body>
<header id="header">
<!-- Top sub-menu Starts Here -->
<div class="mui-appbar mui-container-fulid top-menu">
<div class="mui-container">
<div class="top-menu-item home">
<a href="https://www.tutorialspoint.com/index.htm" target="_blank" title="TutorialsPoint - Home"><i class="fal fa-home"></i> <span>Home</span></a>
</div>
<div class="top-menu-item qa">
<a href="https://www.tutorialspoint.com/about/about_careers.htm" target="_blank" title="Job @ Tutorials Point"><i class="fa fa-suitcase"></i> <span>Jobs</span></a>
</div>
<div class="top-menu-item tools">
<a href="https://www.tutorialspoint.com/online_dev_tools.htm" target="_blank" title="Tools - Online Development and Testing Tools"><i class="fal fa-cogs"></i> <span>Tools</span></a>
</div>
<div class="top-menu-item coding-ground">
<a href="https://www.tutorialspoint.com/codingground.htm" target="_blank" title="Coding Ground - Free Online IDE and Terminal"><i class="fal fa-code"></i> <span>Coding Ground </span></a> 
</div>
<div class="top-menu-item current-affairs">
<a href="https://www.tutorialspoint.com/current_affairs.htm" target="_blank" title="Daily Current Affairs"><i class="fal fa-layer-plus"></i> <span>Current Affairs</span></a>
</div>
<div class="top-menu-item upsc-notes">
<a href="https://www.tutorialspoint.com/upsc_ias_exams.htm" target="_blank" title="UPSC IAS Exams Notes - TutorialsPoint"><i class="fal fa-user-tie"></i> <span>UPSC Notes</span></a>
</div>      
<div class="top-menu-item online-tutoris">
<a href="https://www.tutorialspoint.com/tutor_connect/index.php" target="_blank" title="Top Online Tutors - Tutor Connect"><i class="fal fa-user"></i> <span>Online Tutors</span></a>
</div>
<div class="top-menu-item whiteboard">
<a href="https://www.tutorialspoint.com/whiteboard.htm" target="_blank" title="Free Online Whiteboard"><i class="fal fa-chalkboard"></i> <span>Whiteboard</span></a>
</div>
<div class="top-menu-item net-meeting">
<a href="https://www.tutorialspoint.com/netmeeting.php" target="_blank" title="A free tool for online video conferencing"><i class="fal fa-chalkboard-teacher"></i> <span>Net Meeting</span></a> 
</div>
<div class="top-menu-item articles">
<a href="https://www.tutorix.com" target="_blank" title="Tutorx - The Best Learning App" rel="nofollow"><i class="fal fa-video"></i> <span>Tutorix</span></a> 
</div>        
<div class="social-menu-item">
<a href="https://www.facebook.com/tutorialspointindia" target="_blank" rel="nofollow" data-placement="bottom" title="tutorialspoint @ Facebook"><i class="fab fa-facebook-f"></i></a> 
<a href="https://www.twitter.com/tutorialspoint" target="_blank" rel="nofollow" data-placement="bottom" title="tutorialspoint @ Twitter"><i class="fab fa-twitter"></i></a>
<a href="https://www.linkedin.com/company/tutorialspoint" target="_blank" rel="nofollow" data-placement="bottom" title="tutorialspoint @ Linkedin"><i class="fab fa-linkedin-in"></i></a>
<a href="https://www.youtube.com/channel/UCVLbzhxVTiTLiVKeGV7WEBg" target="_blank" rel="nofollow" data-placement="bottom" title="tutorialspoint YouTube"><i class="fab fa-youtube"></i></a>
</div>        
</div>
</div>
<!-- Top sub-menu Ends Here -->
<!-- Top main-menu Starts Here -->
<div class="mui-appbar mui-container-fulid mui--appbar-line-height mui--z1" id="logo-menu">
<div class="mui-container">
<div class="left-menu">
<a href="https://www.tutorialspoint.com/index.htm" title="Tutorialspoint">
<img class="tp-logo" alt="tutorialspoint" src="/batch_script/images/logo.png">
</a>
<div class="mui-dropdown">
<a class="mui-btn mui-btn--primary categories" data-mui-toggle="dropdown"><i class="fa fa-th-large"></i> 
<span>Categories <span class="mui-caret"></span></span></a>            
<ul class="mui-dropdown__menu cat-menu">
<li>
<ul>
<li><a href="/academic_tutorials.htm"><i class="fa fa-caret-right"></i> Academic Tutorials</a></li>
<li><a href="/big_data_tutorials.htm"><i class="fa fa-caret-right"></i> Big Data &amp; Analytics </a></li>
<li><a href="/computer_programming_tutorials.htm"><i class="fa fa-caret-right"></i> Computer Programming </a></li>
<li><a href="/computer_science_tutorials.htm"><i class="fa fa-caret-right"></i> Computer Science </a></li>
<li><a href="/database_tutorials.htm"><i class="fa fa-caret-right"></i> Databases </a></li>
<li><a href="/devops_tutorials.htm"><i class="fa fa-caret-right"></i> DevOps </a></li>
<li><a href="/digital_marketing_tutorials.htm"><i class="fa fa-caret-right"></i> Digital Marketing </a></li>
<li><a href="/engineering_tutorials.htm"><i class="fa fa-caret-right"></i> Engineering Tutorials </a></li>
<li><a href="/upsc_ias_exams.htm"><i class="fa fa-caret-right"></i> Exams Syllabus </a></li>
<li><a href="/famous_monuments.htm"><i class="fa fa-caret-right"></i> Famous Monuments </a></li>
<li><a href="/gate_exams_tutorials.htm"><i class="fa fa-caret-right"></i> GATE Exams Tutorials</a></li>
<li><a href="/latest_technologies.htm"><i class="fa fa-caret-right"></i> Latest Technologies </a></li>
<li><a href="/machine_learning_tutorials.htm"><i class="fa fa-caret-right"></i> Machine Learning </a></li>
<li><a href="/mainframe_tutorials.htm"><i class="fa fa-caret-right"></i> Mainframe Development </a></li>
<li><a href="/management_tutorials.htm"><i class="fa fa-caret-right"></i> Management Tutorials </a></li>
<li><a href="/maths_tutorials.htm"><i class="fa fa-caret-right"></i> Mathematics Tutorials</a></li>
<li><a href="/microsoft_technologies_tutorials.htm"><i class="fa fa-caret-right"></i> Microsoft Technologies </a></li>
<li><a href="/misc_tutorials.htm"><i class="fa fa-caret-right"></i> Misc tutorials </a></li>
<li><a href="/mobile_development_tutorials.htm"><i class="fa fa-caret-right"></i> Mobile Development </a></li>
<li><a href="/java_technology_tutorials.htm"><i class="fa fa-caret-right"></i> Java Technologies </a></li>
<li><a href="/python_technologies_tutorials.htm"><i class="fa fa-caret-right"></i> Python Technologies </a></li>
<li><a href="/sap_tutorials.htm"><i class="fa fa-caret-right"></i> SAP Tutorials </a></li>
<li><a href="/scripting_lnaguage_tutorials.htm"><i class="fa fa-caret-right"></i>Programming Scripts </a></li>
<li><a href="/selected_reading.htm"><i class="fa fa-caret-right"></i> Selected Reading </a></li>
<li><a href="/software_quality_tutorials.htm"><i class="fa fa-caret-right"></i> Software Quality </a></li>
<li><a href="/soft_skill_tutorials.htm"><i class="fa fa-caret-right"></i> Soft Skills </a></li>
<li><a href="/telecom_tutorials.htm"><i class="fa fa-caret-right"></i> Telecom Tutorials </a></li>
<li><a href="/upsc_ias_exams.htm"><i class="fa fa-caret-right"></i> UPSC IAS Exams </a></li>
<li><a href="/web_development_tutorials.htm"><i class="fa fa-caret-right"></i> Web Development </a></li>
<li><a href="/sports_tutorials.htm"><i class="fa fa-caret-right"></i> Sports Tutorials </a></li>
<li><a href="/xml_technologies_tutorials.htm"><i class="fa fa-caret-right"></i> XML Technologies </a></li>
<li><a href="/multi_language_tutorials.htm"><i class="fa fa-caret-right"></i> Multi-Language Tutorials</a></li>
<li><a href="/questions_and_answers.htm"><i class="fa fa-caret-right"></i> Interview Questions</a></li>
</ul>
</li>
</ul>
<div class="clear"></div>
</div> 
</div>
<div class="right-menu">
<div class="toc-toggle">
<a href="javascript:void(0);"><i class="fa fa-bars"></i></a>
</div>
<div class="mobile-search-btn">
<a href="https://www.tutorialspoint.com/search.htm"><i class="fal fa-search"></i></a>
</div>
<div class="search-box">
<form method="get" class="" name="searchform" action="https://www.google.com/search" target="_blank" novalidate="">
<input type="hidden" name="sitesearch" value="www.tutorialspoint.com" class="user-valid valid">
<input class="header-search-box" type="text" id="search-string" name="q" placeholder="Search your favorite tutorials..." onfocus="if (this.value == 'Search your favorite tutorials...') {this.value = '';}" onblur="if (this.value == '') {this.value = 'Search your favorite tutorials...';}" autocomplete="off">
<button><i class="fal fa-search"></i></button>
</form>
</div>
<div class="menu-btn library-btn">
<a href="https://www.tutorialspoint.com/tutorialslibrary.htm"><i class="fal fa-cubes"></i> <span>Library</span></a>
</div>
<div class="menu-btn videos-btn">
<a href="https://www.tutorialspoint.com/videotutorials/index.htm"><i class="fal fa-video"></i> <span>Videos</span></a> 
</div>
<div class="menu-btn videos-btn">
<a href="https://www.tutorialspoint.com/questions/index.php"><i class="fa fa-location-arrow"></i> <span>Q/A</span></a>
</div>
<div class="menu-btn ebooks-btn">
<a href="https://store.tutorialspoint.com"><i class="fal fa-book"></i> <span>eBooks</span></a>
</div>
<div class="mui-dropdown">
<button class="mui-btn mui-btn--primary" data-mui-toggle="dropdown">
<span class="mui-caret"></span>
</button>
<ul class="mui-dropdown__menu">
<li><a href="https://www.tutorialspoint.com/tutorialslibrary.htm"><i class="fal fa-cubes"></i> <span>Library</span></a></li>
<li><a href="https://www.tutorialspoint.com/videotutorials/index.htm"><i class="fal fa-video"></i> <span>Videos</span></a></li>
<li><a href="https://store.tutorialspoint.com"><i class="fal fa-book"></i> <span>eBooks</span></a></li>
</ul>
</div>
</div>
</div>
</div>
<!-- Top main-menu Ends Here -->
</header>
<div class="mui-container-fluid content">
<div class="mui-container">
<!-- Tutorial ToC Starts Here -->
<div class="mui-col-md-3 tutorial-toc">
<div class="mini-logo">
<img src="/batch_script/images/batch-script-mini-logo.jpg" alt="Batch Script Tutorial" />
</div>
<ul class="toc chapters">
<li class="heading">Batch Script Tutorial</li>
<li><a href="/batch_script/index.htm">Batch Script - Home</a></li>
<li><a href="/batch_script/batch_script_overview.htm">Batch Script - Overview</a></li>
<li><a href="/batch_script/batch_script_environment.htm">Batch Script - Environment</a></li>
<li><a href="/batch_script/batch_script_commands.htm">Batch Script - Commands</a></li>
<li><a href="/batch_script/batch_script_files.htm">Batch Script - Files</a></li>
<li><a href="/batch_script/batch_script_syntax.htm">Batch Script - Syntax</a></li>
<li><a href="/batch_script/batch_script_variables.htm">Batch Script - Variables</a></li>
<li><a href="/batch_script/batch_script_comments.htm">Batch Script - Comments</a></li>
<li><a href="/batch_script/batch_script_strings.htm">Batch Script - Strings</a></li>
<li><a href="/batch_script/batch_script_arrays.htm">Batch Script - Arrays</a></li>
<li><a href="/batch_script/batch_script_decision_making.htm">Batch Script - Decision Making</a></li>
<li><a href="/batch_script/batch_script_operators.htm">Batch Script - Operators</a></li>
<li><a href="/batch_script/batch_script_date_time.htm">Batch Script - DATE &amp; TIME</a></li>
<li><a href="/batch_script/batch_script_input_output.htm">Batch Script - Input / Output</a></li>
<li><a href="/batch_script/batch_script_return_code.htm">Batch Script - Return Code</a></li>
<li><a href="/batch_script/batch_script_functions.htm">Batch Script - Functions</a></li>
<li><a href="/batch_script/batch_script_process.htm">Batch Script - Process</a></li>
<li><a href="/batch_script/batch_script_aliases.htm">Batch Script - Aliases</a></li>
<li><a href="/batch_script/batch_script_devices.htm">Batch Script - Devices</a></li>
<li><a href="/batch_script/batch_script_registry.htm">Batch Script - Registry</a></li>
<li><a href="/batch_script/batch_script_network.htm">Batch Script - Network</a></li>
<li><a href="/batch_script/batch_script_printing.htm">Batch Script - Printing</a></li>
<li><a href="/batch_script/batch_script_debugging.htm">Batch Script - Debugging</a></li>
<li><a href="/batch_script/batch_script_logging.htm">Batch Script - Logging</a></li>
</ul>
<ul class="toc chapters">
<li class="heading">Batch Script Resources</li>
<li><a href="/batch_script/batch_script_quick_guide.htm">Batch Script - Quick Guide</a></li>
<li><a href="/batch_script/batch_script_useful_resources.htm">Batch Script - Useful Resources</a></li>
<li><a href="/batch_script/batch_script_discussion.htm">Batch Script - Discussion</a></li>
</ul>
<ul class="toc reading">
<li class="sreading">Selected Reading</li>
<li><a target="_top" href="/upsc_ias_exams.htm">UPSC IAS Exams Notes</a></li>
<li><a target="_top" href="/developers_best_practices/index.htm">Developer's Best Practices</a></li>
<li><a target="_top" href="/questions_and_answers.htm">Questions and Answers</a></li>
<li><a target="_top" href="/effective_resume_writing.htm">Effective Resume Writing</a></li>
<li><a target="_top" href="/hr_interview_questions/index.htm">HR Interview Questions</a></li>
<li><a target="_top" href="/computer_glossary.htm">Computer Glossary</a></li>
<li><a target="_top" href="/computer_whoiswho.htm">Who is Who</a></li>
</ul>
</div>
<!-- Tutorial ToC Ends Here -->
<!-- Tutorial Content Starts Here -->
<div class="mui-col-md-6 tutorial-content">
<h1>Batch Script - Quick Guide</h1>
<hr />
<div class="top-ad-heading">Advertisements</div>
<div style="text-align: center;">
<script><!--
google_ad_client = "pub-7133395778201029";
var width = document.getElementsByClassName("tutorial-content")[0].clientWidth - 40;
google_ad_width = width;
google_ad_height = 150;
google_ad_format = width + "x150_as";
google_ad_type = "image";
google_ad_channel = "";
//--></script>
<script src="https://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>
<div class="mui-container-fluid button-borders">
<div class="pre-btn">
<a href="/batch_script/batch_script_logging.htm"><i class="fal fa-chevron-circle-left"></i> Previous Page</a>
</div>
<div class="nxt-btn">
<a href="/batch_script/batch_script_useful_resources.htm">Next Page <i class="fal fa-chevron-circle-right"></i>&nbsp;</a>
</div>
</div>
<div class="clearer"></div>
<h1>Batch Script - Overview</h1>
<p>Batch Script is incorporated to automate command sequences which are repetitive in nature. Scripting is a way by which one can alleviate this necessity by automating these command sequences in order to make one’s life at the shell easier and more productive. In most organizations, Batch Script is incorporated in some way or the other to automate stuff.</p>
<p>Some of the features of Batch Script are &minus;</p>
<ul class="list">
<li><p>Can read inputs from users so that it can be processed further.</p></li>
<li><p>Has control structures such as for, if, while, switch for better automating and scripting.</p></li>
<li><p>Supports advanced features such as Functions and Arrays.</p></li>
<li><p>Supports regular expressions.</p></li>
<li><p>Can include other programming codes such as Perl.</p></li>
</ul>
<p>Some of the common uses of Batch Script are &minus;</p>
<ul class="list">
<li><p>Setting up servers for different purposes.</p></li>
<li><p>Automating housekeeping activities such as deleting unwanted files or log files.</p></li>
<li><p>Automating the deployment of applications from one environment to another.</p></li>
<li><p>Installing programs on various machines at once.</p></li>
</ul>
<p>Batch scripts are stored in simple text files containing lines with commands that get executed in sequence, one after the other. These files have the special extension BAT or CMD. Files of this type are recognized and executed through an interface (sometimes called a shell) provided by a system file called the command interpreter. On Windows systems, this interpreter is known as cmd.exe.</p>
<p>Running a batch file is a simple matter of just clicking on it. Batch files can also be run in a command prompt or the Start-Run line. In such case, the full path name must be used unless the file's path is in the path environment. Following is a simple example of a Batch Script. This Batch Script when run deletes all files in the current directory.</p>
<pre class="result notranslate">
:: Deletes All files in the Current Directory With Prompts and Warnings
::(Hidden, System, and Read-Only Files are Not Affected)
:: &commat;ECHO OFF
DEL . DR
</pre>
<h1>Batch Script - Environment</h1>
<p>This chapter explains the environment related to Batch Script.</p>
<h2>Writing and Executing</h2>
<p>Typically, to create a batch file, notepad is used. This is the simplest tool for creation of batch files. Next is the execution environment for the batch scripts. On Windows systems, this is done via the command prompt or cmd.exe. All batch files are run in this environment.</p>
<p>Following are the different ways to launch cmd.exe &minus;</p>
<p><b>Method 1</b> &minus; Go to C:\Windows\System32 and double click on the cmd file.</p>
<img src="/batch_script/images/writing_executing_method1.jpg" alt="Writing Executing Method1" />
<p><b>Method 2</b> &minus; Via the run command – The following snapshot shows to find the command prompt(cmd.exe) on Windows server 2012.</p>
<img src="/batch_script/images/writing_executing_method2.jpg" alt="Writing Executing Method2" />
<p>Once the cmd.exe is launched, you will be presented with the following screen. This will be your environment for executing your batch scripts.</p>
<img src="/batch_script/images/batch_script_environment.jpg" alt="Batch Scripting Environment" />
<h2>Environment Variables</h2>
<p>In order to run batch files from the command prompt, you either need to go to the location to where the batch file is stored or alternatively you can enter the file location in the path environment variable. Thus assuming that the batch file is stored in the location <code>C:\Application\bin</code>, you would need to follow these instructions for the PATH variable inclusion.</p>
<table class="table table-bordered">
<tr>
<th style="text-align:center;">OS</th>
<th style="text-align:center;">Output</th>
</tr>
<tr>
<td class="ts">Windows</td>
<td>Append the String; <code>C:\Application\bin</code> to the end of the system variable PATH.</td>
</tr>
</table>
<h1>Batch Script - Commands</h1>
<p>In this chapter, we will look at some of the frequently used batch commands.</p>
<table class="table table-bordered">
<tr>
<th>S.No</th>
<th style="text-align:center;">Commands &amp; Description</th>
</tr>
<tr>
<td class="ts">1</td>
<td><a href="/batch_script/batch_script_ver.htm">VER</a>
<p>This batch command shows the version of MS-DOS you are using.</p></td>
</tr>
<tr>
<td class="ts">2</td>
<td><a href="/batch_script/batch_script_assoc.htm">ASSOC</a>
<p>This is a batch command that associates an extension with a file type (FTYPE), displays existing associations, or deletes an association.</p></td>
</tr>
<tr>
<td class="ts">3</td>
<td><a href="/batch_script/batch_script_cd.htm">CD</a>
<p>This batch command helps in making changes to a different directory, or displays the current directory.</p></td>
</tr>
<tr>
<td class="ts">4</td>
<td><a href="/batch_script/batch_script_cls.htm">CLS</a>
<p>This batch command clears the screen.</p></td>
</tr>
<tr>
<td class="ts">5</td>
<td><a href="/batch_script/batch_script_copy.htm">COPY</a>
<p>This batch command is used for copying files from one location to the other.</p></td>
</tr>
<tr>
<td class="ts">6</td>
<td><a href="/batch_script/batch_script_del.htm">DEL</a>
<p>This batch command deletes files and not directories.</p></td>
</tr>
<tr>
<td class="ts">7</td>
<td><a href="/batch_script/batch_script_dir.htm">DIR</a>
<p>This batch command lists the contents of a directory.</p></td>
</tr>
<tr>
<td class="ts">8</td>
<td><a href="/batch_script/batch_script_date.htm">DATE</a>
<p>This batch command help to find the system date.</p></td>
</tr>
<tr>
<td class="ts">9</td>
<td><a href="/batch_script/batch_script_echo.htm">ECHO</a>
<p>This batch command displays messages, or turns command echoing on or off.</p></td>
</tr>
<tr>
<td class="ts">10</td>
<td><a href="/batch_script/batch_script_exit.htm">EXIT</a>
<p>This batch command exits the DOS console.</p></td>
</tr>
<tr>
<td class="ts">11</td>
<td><a href="/batch_script/batch_script_md.htm">MD</a>
<p>This batch command creates a new directory in the current location.</p></td>
</tr>
<tr>
<td class="ts">12</td>
<td><a href="/batch_script/batch_script_move.htm">MOVE</a>
<p>This batch command moves files or directories between directories.</p></td>
</tr>
<tr>
<td class="ts">13</td>
<td><a href="/batch_script/batch_script_path.htm">PATH</a>
<p>This batch command displays or sets the path variable.</p></td>
</tr>
<tr>
<td class="ts">14</td>
<td><a href="/batch_script/batch_script_pause.htm">PAUSE</a>
<p>This batch command prompts the user and waits for a line of input to be entered.</p></td>
</tr>
<tr>
<td class="ts">15</td>
<td><a href="/batch_script/batch_script_prompt.htm">PROMPT</a>
<p>This batch command can be used to change or reset the cmd.exe prompt.</p></td>
</tr>
<tr>
<td class="ts">16</td>
<td><a href="/batch_script/batch_script_rd.htm">RD</a>
<p>This batch command removes directories, but the directories need to be empty before they can be removed.</p></td>
</tr>
<tr>
<td class="ts">17</td>
<td><a href="/batch_script/batch_script_ren.htm">REN</a>
<p>Renames files and directories</p></td>
</tr>
<tr>
<td class="ts">18</td>
<td><a href="/batch_script/batch_script_rem.htm">REM</a>
<p>This batch command is used for remarks in batch files, preventing the content of the remark from being executed.</p></td>
</tr>
<tr>
<td class="ts">19</td>
<td><a href="/batch_script/batch_script_start.htm">START</a>
<p>This batch command starts a program in new window, or opens a document.</p></td>
</tr>
<tr>
<td class="ts">20</td>
<td><a href="/batch_script/batch_script_time.htm">TIME</a>
<p>This batch command sets or displays the time.</p></td>
</tr>
<tr>
<td class="ts">21</td>
<td><a href="/batch_script/batch_script_type.htm">TYPE</a>
<p>This batch command prints the content of a file or files to the output.</p></td>
</tr>
<tr>
<td class="ts">22</td>
<td><a href="/batch_script/batch_script_vol.htm">VOL</a>
<p>This batch command displays the volume labels.</p></td>
</tr>
<tr>
<td class="ts">23</td>
<td><a href="/batch_script/batch_script_attrib.htm">ATTRIB</a>
<p>Displays or sets the attributes of the files in the curret directory</p></td>
</tr>
<tr>
<tr>
<td class="ts">24</td>
<td><a href="/batch_script/batch_script_chkdsk.htm">CHKDSK</a>
<p>This batch command checks the disk for any problems.</p></td>
</tr>
<tr>
<td class="ts">25</td>
<td><a href="/batch_script/batch_script_choice.htm">CHOICE</a>
<p>This batch command provides a list of options to the user.</p></td>
</tr>
<tr>
<td class="ts">26</td>
<td><a href="/batch_script/batch_script_cmd.htm">CMD</a>
<p>This batch command invokes another instance of command prompt.</p></td>
</tr>
<tr>
<td class="ts">27</td>
<td><a href="/batch_script/batch_script_comp.htm">COMP</a>
<p>This batch command compares 2 files based on the file size.</p></td>
</tr>
<tr>
<td class="ts">28</td>
<td><a href="/batch_script/batch_script_convert.htm">CONVERT</a>
<p>This batch command converts a volume from FAT16 or FAT32 file system to NTFS file system.</p></td>
</tr>
<tr>
<td class="ts">29</td>
<td><a href="/batch_script/batch_script_driverquery.htm">DRIVERQUERY</a>
<p>This batch command shows all installed device drivers and their properties.</p></td>
</tr>
<tr>
<td class="ts">30</td>
<td><a href="/batch_script/batch_script_expand.htm">EXPAND</a>
<p>This batch command extracts files from compressed .cab cabinet files.</p></td>
</tr>
<tr>
<td class="ts">31</td>
<td><a href="/batch_script/batch_script_find.htm">FIND</a>
<p>This batch command searches for a string in files or input, outputting matching lines.</p></td>
</tr>
<tr>
<td class="ts">32</td>
<td><a href="/batch_script/batch_script_format.htm">FORMAT</a>
<p>This batch command formats a disk to use Windows-supported file system such as FAT, FAT32 or NTFS, thereby overwriting the previous content of the disk.</p></td>
</tr>
<tr>
<td class="ts">33</td>
<td><a href="/batch_script/batch_script_help.htm">HELP</a>
<p>This batch command shows the list of Windows-supplied commands.</p></td>
</tr>
<tr>
<td class="ts">34</td>
<td><a href="/batch_script/batch_script_ipconfig.htm">IPCONFIG</a>
<p>This batch command displays Windows IP Configuration. Shows configuration by connection and the name of that connection.</p></td>
</tr>
<tr>
<td class="ts">35</td>
<td><a href="/batch_script/batch_script_label.htm">LABEL</a>
<p>This batch command adds, sets or removes a disk label.</p></td>
</tr>
<tr>
<td class="ts">36</td>
<td><a href="/batch_script/batch_script_more.htm">MORE</a>
<p>This batch command displays the contents of a file or files, one screen at a time.</p></td>
</tr>
<tr>
<td class="ts">37</td>
<td><a href="/batch_script/batch_script_net.htm">NET</a>
<p>Provides various network services, depending on the command used.</p></td>
</tr>
<tr>
<td class="ts">38</td>
<td><a href="/batch_script/batch_script_ping.htm">PING</a>
<p>This batch command sends ICMP/IP "echo" packets over the network to the designated address.</p></td>
</tr>
<tr>
<td class="ts">39</td>
<td><a href="/batch_script/batch_script_shutdown.htm">SHUTDOWN</a>
<p>This batch command shuts down a computer, or logs off the current user.</p></td>
</tr>
<tr>
<td class="ts">40</td>
<td><a href="/batch_script/batch_script_sort.htm">SORT</a>
<p>This batch command takes the input from a source file and sorts its contents alphabetically, from A to Z or Z to A. It prints the output on the console.</p></td>
</tr>
<tr>
<td class="ts">41</td>
<td><a href="/batch_script/batch_script_subst.htm">SUBST</a>
<p>This batch command assigns a drive letter to a local folder, displays current assignments, or removes an assignment.</p></td>
</tr>
<tr>
<td class="ts">42</td>
<td><a href="/batch_script/batch_script_systeminfo.htm">SYSTEMINFO</a>
<p>This batch command shows configuration of a computer and its operating system.</p></td>
</tr>
<tr>
<td class="ts">43</td>
<td><a href="/batch_script/batch_script_taskkill.htm">TASKKILL</a>
<p>This batch command ends one or more tasks.</p></td>
</tr>
<tr>
<td class="ts">44</td>
<td><a href="/batch_script/batch_script_tasklist.htm">TASKLIST</a>
<p>This batch command lists tasks, including task name and process id (PID).</p></td>
</tr>
<tr>
<td class="ts">45</td>
<td><a href="/batch_script/batch_script_xcopy.htm">XCOPY</a>
<p>This batch command copies files and directories in a more advanced way.</p></td>
</tr>
<tr>
<td class="ts">46</td>
<td><a href="/batch_script/batch_script_tree.htm">TREE</a>
<p>This batch command displays a tree of all subdirectories of the current directory to any level of recursion or depth.</p></td>
</tr>
<tr>
<td class="ts">47</td>
<td><a href="/batch_script/batch_script_fc.htm">FC</a>
<p>This batch command lists the actual differences between two files.</p></td>
</tr>
<tr>
<td class="ts">48</td>
<td><a href="/batch_script/batch_script_diskpart.htm">DISKPART</a>
<p>This batch command shows and configures the properties of disk partitions.</p></td>
</tr>
<tr>
<td class="ts">49</td>
<td><a href="/batch_script/batch_script_title.htm">TITLE</a>
<p>This batch command sets the title displayed in the console window.</p></td>
</tr>
<tr>
<td class="ts">50</td>
<td><a href="/batch_script/batch_script_set.htm">SET</a>
<p>Displays the list of environment variables on the current system.</p></td>
</tr>
</table>
<h1>Batch Script - Files</h1>
<p>In this chapter, we will learn how to create, save, execute, and modify batch files.</p>
<h2>Creating Batch Files</h2>
<p>Batch files are normally created in notepad. Hence the simplest way is to open notepad and enter the commands required for the script. For this exercise, open notepad and enter the following statements.</p>
<pre class="prettyprint notranslate">
:: Deletes All files in the Current Directory With Prompts and Warnings 
::(Hidden, System, and Read-Only Files are Not Affected) 
:: 
&commat;ECHO OFF 
DEL . 
DR
</pre>
<h2>Saving Batch Files</h2>
<p>After your batch file is created, the next step is to save your batch file. Batch files have the extension of either .bat or .cmd. Some general rules to keep in mind when naming batch files &minus;</p>
<ul class="list">
<li><p>Try to avoid spaces when naming batch files, it sometime creates issues when they are called from other scripts.</p></li>
<li><p>Don’t name them after common batch files which are available in the system such as ping.cmd.</p></li>
</ul>
<img src="/batch_script/images/saving_batch_files.jpg" alt="Saving Batch Files" />
<p>The above screenshot shows how to save the batch file. When saving your batch file a few points to keep in mind.</p>
<ul class="list">
<li>Remember to put the .bat or .cmd at the end of the file name.</li>
<li>Choose the “Save as type” option as “All Files”.</li>
<li>Put the entire file name in quotes “”.</li>
</ul>
<h2>Executing Batch Files</h2>
<p>Following are the steps to execute a batch file &minus;</p>
<ul class="list">
<li><p><b>Step 1</b> &minus; Open the command prompt (cmd.exe).</p></li>
<li><p><b>Step 2</b> &minus; Go to the location where the .bat or .cmd file is stored.</p></li>
<li><p><b>Step 3</b> &minus; Write the name of the file as shown in the following image and press the Enter button to execute the batch file.</p></li>
</ul>
<img src="/batch_script/images/executing_batch_files.jpg" alt="Executing Batch Files" />
<h2>Modifying Batch Files</h2>
<p>Following are the steps for modifying an existing batch file.</p>
<ul class="list">
<li><p><b>Step 1</b> &minus; Open windows explorer.</p></li>
<li><p><b>Step 2</b> &minus; Go to the location where the .bat or .cmd file is stored.</p></li>
<li><p><b>Step 3</b> &minus; Right-click the file and choose the “Edit” option from the context menu. The file will open in Notepad for further editing.</p></li>
</ul>
<img src="/batch_script/images/modifying_batch_files.jpg" alt="Modifying Batch Files" />
<h1>Batch Script - Syntax</h1>
<p>Normally, the first line in a batch file often consists of the following command.</p>
<h2>ECHO Command</h2>
<pre class="result notranslate">
&commat;echo off
</pre>
<p>By default, a batch file will display its command as it runs. The purpose of this first command is to turn off this display. The command "echo off" turns off the display for the whole script, except for the "echo off" command itself. The "at" sign "&commat;" in front makes the command apply to itself as well.</p>
<h2>Documentation</h2>
<p>Very often batch files also contains lines that start with the "Rem" command. This is a way to enter comments and documentation. The computer ignores anything on a line following Rem. For batch files with increasing amount of complexity, this is often a good idea to have comments.</p>
<h2>First Batch Script Program</h2>
<p>Let’s construct our simple first batch script program. Open notepad and enter the following lines of code. Save the file as “List.cmd”.</p>
<p>The code does the following &minus;</p>
<ul class="list">
<li><p>Uses the echo off command to ensure that the commands are not shown when the code is executed.</p></li>
<li><p>The Rem command is used to add a comment to say what exactly this batch file does.</p></li>
<li><p>The dir command is used to take the contents of the location C:\Program Files.</p></li>
<li><p>The ‘&gt;’ command is used to redirect the output to the file C:\lists.txt.</p></li>
<li><p>Finally, the echo command is used to tell the user that the operation is completed.</p></li>
</ul>
<pre class="prettyprint notranslate">
&commat;echo off 
Rem This is for listing down all the files in the directory Program files 
dir "C:\Program Files" &gt; C:\lists.txt 
echo "The program has completed"
</pre>
<p>When the above command is executed, the names of the files in C:\Program Files will be sent to the file C:\Lists.txt and in the command prompt the message “The program has completed” will be displayed.</p>
<h1>Batch Script - Variables</h1>
<p>There are two types of variables in batch files. One is for parameters which can be passed when the batch file is called and the other is done via the set command.</p>
<h2>Command Line Arguments</h2>
<p>Batch scripts support the concept of command line arguments wherein arguments can be passed to the batch file when invoked. The arguments can be called from the batch files through the variables %1, %2, %3, and so on.</p>
<p>The following example shows a batch file which accepts 3 command line arguments and echo’s them to the command line screen.</p>
<pre class="prettyprint notranslate">
&commat;echo off 
echo %1 
echo %2 
echo %3
</pre>
<p>If the above batch script is stored in a file called test.bat and we were to run the batch as</p>
<pre class="result notranslate">
Test.bat 1 2 3
</pre>
<p>Following is a screenshot of how this would look in the command prompt when the batch file is executed.</p>
<img src="/batch_script/images/command_line_arguments.jpg" alt="Command Line Arguments" />
<p>The above command produces the following output.</p>
<pre class="result notranslate">
1 
2 
3
</pre>
<p>If we were to run the batch as</p>
<pre class="result notranslate">
Example 1 2 3 4
</pre>
<p>The output would still remain the same as above. However, the fourth parameter would be ignored.</p>
<h2>Set Command</h2>
<p>The other way in which variables can be initialized is via the ‘set’ command. Following is the syntax of the set command.</p>
<h3>Syntax</h3>
<pre class="result notranslate">
set /A variable-name=value
</pre>
<p>where,</p>
<ul class="list">
<li><p><b>variable-name</b> is the name of the variable you want to set.</p></li>
<li><p><b>value</b> is the value which needs to be set against the variable.</p></li>
<li><p><b>/A –</b> This switch is used if the value needs to be numeric in nature.</p></li>
</ul>
<p>The following example shows a simple way the set command can be used.</p>
<h3>Example</h3>
<pre class="prettyprint notranslate">
&commat;echo off 
set message=Hello World 
echo %message%
</pre>
<ul class="list">
<li><p>In the above code snippet, a variable called message is defined and set with the value of "Hello World".</p></li>
<li><p>To display the value of the variable, note that the variable needs to be enclosed in the % sign.</p></li>
</ul>
<h3>Output</h3>
<p>The above command produces the following output.</p>
<pre class="result notranslate">
Hello World
</pre>
<h2>Working with Numeric Values</h2>
<p>In batch script, it is also possible to define a variable to hold a numeric value. This can be done by using the /A switch.</p>
<p>The following code shows a simple way in which numeric values can be set with the /A switch.</p>
<pre class="prettyprint notranslate">
&commat;echo off 
SET /A a = 5 
SET /A b = 10 
SET /A c = %a% &plus; %b% 
echo %c%
</pre>
<ul class="list">
<li><p>We are first setting the value of 2 variables, a and b to 5 and 10 respectively.</p></li>
<li><p>We are adding those values and storing in the variable c.</p></li>
<li><p>Finally, we are displaying the value of the variable c.</p></li>
</ul>
<p>The output of the above program would be 15.</p>
<p>All of the arithmetic operators work in batch files. The following example shows arithmetic operators can be used in batch files.</p>
<pre class="prettyprint notranslate">
&commat;echo off 
SET /A a = 5 
SET /A b = 10 
SET /A c = %a% &plus; %b% 
echo %c% 
SET /A c = %a% - %b% 
echo %c% 
SET /A c = %b% / %a% 
echo %c% 
SET /A c = %b% * %a% 
echo %c%
</pre>
<p>The above command produces the following output.</p>
<pre class="result notranslate">
15 
-5 
2 
50
</pre>
<h2>Local vs Global Variables</h2>
<p>In any programming language, there is an option to mark variables as having some sort of scope, i.e. the section of code on which they can be accessed. Normally, variable having a global scope can be accessed anywhere from a program whereas local scoped variables have a defined boundary in which they can be accessed.</p>
<p>DOS scripting also has a definition for locally and globally scoped variables. By default, variables are global to your entire command prompt session. Call the SETLOCAL command to make variables local to the scope of your script. After calling SETLOCAL, any variable assignments revert upon calling ENDLOCAL, calling EXIT, or when execution reaches the end of file (EOF) in your script. The following example shows the difference when local and global variables are set in the script.</p>
<h3>Example</h3>
<pre class="prettyprint notranslate">
&commat;echo off 
set globalvar = 5
SETLOCAL
set var = 13145
set /A var = %var% + 5
echo %var%
echo %globalvar%
ENDLOCAL
</pre>
<p>Few key things to note about the above program.</p>
<ul class="list">
<li><p>The ‘globalvar’ is defined with a global scope and is available throughout the entire script.</p></li>
<li><p>The ‘var‘ variable is defined in a local scope because it is enclosed between a ‘SETLOCAL’ and ‘ENDLOCAL’ block. Hence, this variable will be destroyed as soon the ‘ENDLOCAL’ statement is executed.</p></li>
</ul>
<h3>Output</h3>
<p>The above command produces the following output.</p>
<pre class="result notranslate">
13150
5
</pre>
<p>You will notice that the command echo %var% will not yield anything because after the ENDLOCAL statement, the ‘var’ variable will no longer exist.</p>
<h2>Working with Environment Variables</h2>
<p>If you have variables that would be used across batch files, then it is always preferable to use environment variables. Once the environment variable is defined, it can be accessed via the % sign. The following example shows how to see the JAVA_HOME defined on a system. The JAVA_HOME variable is a key component that is normally used by a wide variety of applications.</p>
<pre class="prettyprint notranslate">
&commat;echo off 
echo %JAVA_HOME%
</pre>
<p>The output would show the JAVA_HOME directory which would depend from system to system. Following is an example of an output.</p>
<pre class="result notranslate">
C:\Atlassian\Bitbucket\4.0.1\jre
</pre>
<h1>Batch Script - Comments</h1>
<p>It’s always a good practice to add comments or documentation for the scripts which are created. This is required for maintenance of the scripts to understand what the script actually does.</p>
<p>For example, consider the following piece of code which has no form of comments. If any average person who has not developed the following script tries to understand the script, it would take a lot of time for that person to understand what the script actually does.</p>
<pre class="prettyprint notranslate">
ECHO OFF 
IF NOT "%OS%"=="Windows_NT" GOTO Syntax 
ECHO.%* | FIND "?" &gt;NUL 
IF NOT ERRORLEVEL 1 GOTO Syntax 
IF NOT [%2]==[] GOTO Syntax 
SETLOCAL 
SET WSS= 
IF NOT [%1]==[] FOR /F "tokens = 1 delims = \ " %%A IN ('ECHO.%~1') DO SET WSS = %%A 
FOR /F "tokens = 1 delims = \ " %%a IN ('NET VIEW ^| FIND /I "\\%WSS%"') DO FOR /F 
"tokens = 1 delims = " %%A IN ('NBTSTAT -a %%a ^| FIND /I /V "%%a" ^| FIND "&lt;03&gt;"') 
DO ECHO.%%a %%A 
ENDLOCAL 
GOTO:EOF 
ECHO Display logged on users and their workstations. 
ECHO Usage: ACTUSR [ filter ] 
IF "%OS%"=="Windows_NT" ECHO Where: filter is the first part 
of the computer name^(s^) to be displayed
</pre>
<h2>Comments Using the Rem Statement</h2>
<p>There are two ways to create comments in Batch Script; one is via the Rem command. Any text which follows the Rem statement will be treated as comments and will not be executed. Following is the general syntax of this statement.</p>
<h3>Syntax</h3>
<pre class="result notranslate">
Rem Remarks
</pre>
<p>where ‘Remarks’ is the comments which needs to be added.</p>
<p>The following example shows a simple way the <b>Rem</b> command can be used.</p>
<h3>Example</h3>
<pre class="prettyprint notranslate">
&commat;echo off 
Rem This program just displays Hello World 
set message=Hello World 
echo %message%
</pre>
<h3>Output</h3>
<p>The above command produces the following output. You will notice that the line with the Rem statement will not be executed.</p>
<pre class="result notranslate">
Hello World
</pre>
<h2>Comments Using the :: Statement</h2>
<p>The other way to create comments in Batch Script is via the :: command. Any text which follows the :: statement will be treated as comments and will not be executed. Following is the general syntax of this statement.</p>
<h3>Syntax</h3>
<pre class="result notranslate">
:: Remarks
</pre>
<p>where ‘Remarks’ is the comment which needs to be added.</p>
<p>The following example shows a simple way the Rem command can be used.</p>
<h3>Example</h3>
<pre class="prettyprint notranslate">
&commat;echo off 
:: This program just displays Hello World 
set message = Hello World 
echo %message%
</pre>
<h3>Output</h3>
<p>The above command produces the following output. You will notice that the line with the :: statement will not be executed.</p>
<pre class="result notranslate">
Hello World
</pre>
<p><b>Note</b> &minus; If you have too many lines of Rem, it could slow down the code, because in the end each line of code in the batch file still needs to be executed.</p>
<p>Let’s look at the example of the large script we saw at the beginning of this topic and see how it looks when documentation is added to it.</p>
<pre class="prettyprint notranslate">
::===============================================================
:: The below example is used to find computer and logged on users
::
::===============================================================
ECHO OFF 
:: Windows version check 
IF NOT "%OS%"=="Windows_NT" GOTO Syntax 
ECHO.%* | FIND "?" &gt;NUL 
:: Command line parameter check 
IF NOT ERRORLEVEL 1 GOTO Syntax
IF NOT [%2]==[] GOTO Syntax 
:: Keep variable local 
SETLOCAL 
:: Initialize variable 
SET WSS= 
:: Parse command line parameter 
IF NOT [%1]==[] FOR /F "tokens = 1 delims = \ " %%A IN ('ECHO.%~1') DO SET WSS = %%A 
:: Use NET VIEW and NBTSTAT to find computers and logged on users 
FOR /F "tokens = 1 delims = \ " %%a IN ('NET VIEW ^| FIND /I "\\%WSS%"') DO FOR /F 
"tokens = 1 delims = " %%A IN ('NBTSTAT -a %%a ^| FIND /I /V "%%a" ^| FIND 
"&lt;03&gt;"') DO ECHO.%%a %%A 
:: Done 
ENDLOCAL
GOTO:EOF 
:Syntax 
ECHO Display logged on users and their workstations. 
ECHO Usage: ACTUSR [ filter ] 
IF "%OS%"=="Windows_NT" ECHO Where: filter is the first part of the 
computer name^(s^) to be displayed
</pre>
<p>You can now see that the code has become more understandable to users who have not developed the code and hence is more maintainable.</p>
<h1>Batch Script - Strings</h1>
<p>In DOS, a string is an ordered collection of characters, such as "Hello, World!".</p>
<table class="table table-bordered">
<tr>
<th>S.No</th>
<th style="text-align:center;">Strings &amp; Description</th>
</tr>
<tr>
<td class="ts">1</td>
<td><a href="/batch_script/batch_script_create_string.htm">Create String</a>
<p>A string can be created in DOS in the following way.</p></td>
</tr>
<tr>
<td class="ts">2</td>
<td><a href="/batch_script/batch_script_empty_string.htm">Empty String</a>
<p>Empty String</p></td>
</tr>
<tr>
<td class="ts">3</td>
<td><a href="/batch_script/batch_script_string_interpolation.htm">String Interpolation</a>
<p>String interpolation is a way to construct a new String value from a mix of constants, variables, literals, and expressions by including their values inside a string literal.</p></td>
</tr>
<tr>
<td class="ts">4</td>
<td><a href="/batch_script/batch_script_string_concatenation.htm">String Concatenation</a>
<p>You can use the set operator to concatenate two strings or a string and a character, or two characters. Following is a simple example which shows how to use string concatenation.</p></td>
</tr>
<tr>
<td class="ts">5</td>
<td><a href="/batch_script/batch_script_string_length.htm">String length</a>
<p>In DOS scripting, there is no length function defined for finding the length of a string. There are custom-defined functions which can be used for the same. Following is an example of a custom-defined function for seeing the length of a string.</p></td>
</tr>
<tr>
<td class="ts">6</td>
<td><a href="/batch_script/batch_script_toint.htm">toInt</a>
<p>A variable which has been set as string using the set variable can be converted to an integer using the /A switch which is using the set variable. The following example shows how this can be accomplished.</p></td>
</tr>
<tr>
<td class="ts">7</td>
<td><a href="/batch_script/batch_script_align_right.htm">Align Right</a>
<p>This used to align text to the right, which is normally used to improve readability of number columns.</p></td>
</tr>
<tr>
<td class="ts">8</td>
<td><a href="/batch_script/batch_script_left_string.htm">Left String</a>
<p>This is used to extract characters from the beginning of a string.</p></td>
</tr>
<tr>
<td class="ts">9</td>
<td><a href="/batch_script/batch_script_mid_string.htm">Mid String</a>
<p>This is used to extract a substring via the position of the characters in the string.</p></td>
</tr>
<tr>
<td class="ts">10</td>
<td><a href="/batch_script/batch_script_remove.htm">Remove</a>
<p>The string substitution feature can also be used to remove a substring from another string.</p></td>
</tr>
<tr>
<td class="ts">11</td>
<td><a href="/batch_script/batch_script_remove_both_ends.htm">Remove Both Ends</a>
<p>This is used to remove the first and the last character of a string.</p></td>
</tr>
<tr>
<td class="ts">12</td>
<td><a href="/batch_script/batch_script_remove_all_spaces.htm">Remove All Spaces</a>
<p>This is used to remove all spaces in a string via substitution.</p></td>
</tr>
<tr>
<td class="ts">13</td>
<td><a href="/batch_script/batch_script_replace_string.htm">Replace a String</a>
<p>To replace a substring with another string use the string substitution feature.</p></td>
</tr>
<tr>
<td class="ts">14</td>
<td><a href="/batch_script/batch_script_right_string.htm">Right String</a>
<p>This is used to extract characters from the end of a string.</p></td>
</tr>
</table>
<h1>Batch Script - Arrays</h1>
<p>Arrays are not specifically defined as a type in Batch Script but can be implemented. The following things need to be noted when arrays are implemented in Batch Script.</p>
<ul class="list">
<li>Each element of the array needs to be defined with the set command.</li>
<li>The ‘for’ loop would be required to iterate through the values of the array.</li>
</ul>
<h2>Creating an Array</h2>
<p>An array is created by using the following set command.</p>
<pre class="result notranslate">
set a[0]=1
</pre> 
<p>Where 0 is the index of the array and 1 is the value assigned to the first element of the array.</p>
<p>Another way to implement arrays is to define a list of values and iterate through the list of values. The following example show how this can be implemented.</p>
<h3>Example</h3>
<pre class="prettyprint notranslate">
&commat;echo off 
set list = 1 2 3 4 
(for %%a in (%list%) do ( 
   echo %%a 
))
</pre>
<h3>Output</h3>
<p>The above command produces the following output.</p>
<pre class="result notranslate">
1
2
3
4
</pre>
<h2>Accessing Arrays</h2>
<p>You can retrieve a value from the array by using subscript syntax, passing the index of the value you want to retrieve within square brackets immediately after the name of the array.</p>
<h3>Example</h3>
<pre class="prettyprint notranslate">
&commat;echo off 
set a[0]=1 
echo %a[0]%
</pre>
<p>In this example, the index starts from 0 which means the first element can be accessed using index as 0, the second element can be accessed using index as 1 and so on. Let's check the following example to create, initialize and access arrays &minus;</p>
<pre class="prettyprint notranslate">
&commat;echo off
set a[0] = 1 
set a[1] = 2 
set a[2] = 3 
echo The first element of the array is %a[0]% 
echo The second element of the array is %a[1]% 
echo The third element of the array is %a[2]%
</pre>
<p>The above command produces the following output.</p>
<pre class="result notranslate">
The first element of the array is 1 
The second element of the array is 2 
The third element of the array is 3
</pre>
<h2>Modifying an Array</h2>
<p>To add an element to the end of the array, you can use the set element along with the last index of the array element.</p>
<h3>Example</h3>
<pre class="prettyprint notranslate">
&commat;echo off 
set a[0] = 1  
set a[1] = 2  
set a[2] = 3 
Rem Adding an element at the end of an array 
Set a[3] = 4 
echo The last element of the array is %a[3]%
</pre>
<p>The above command produces the following output.</p>
<pre class="result notranslate">
The last element of the array is 4
</pre>
<p>You can modify an existing element of an Array by assigning a new value at a given index as shown in the following example &minus;</p>
<pre class="prettyprint notranslate">
&commat;echo off 
set a[0] = 1 
set a[1] = 2  
set a[2] = 3 
Rem Setting the new value for the second element of the array 
Set a[1] = 5 
echo The new value of the second element of the array is %a[1]%
</pre>
<p>The above command produces the following output.</p>
<pre class="result notranslate">
The new value of the second element of the array is 5
</pre>
<h2>Iterating Over an Array</h2>
<p>Iterating over an array is achieved by using the ‘for’ loop and going through each element of the array. The following example shows a simple way that an array can be implemented.</p>
<pre class="prettyprint notranslate">
&commat;echo off 
setlocal enabledelayedexpansion 
set topic[0] = comments 
set topic[1] = variables 
set topic[2] = Arrays 
set topic[3] = Decision making 
set topic[4] = Time and date 
set topic[5] = Operators 

for /l %%n in (0,1,5) do ( 
   echo !topic[%%n]! 
)
</pre>
<p>Following things need to be noted about the above program &minus;</p>
<ul class="list">
<li><p>Each element of the array needs to be specifically defined using the set command.</p></li>
<li><p>The ‘for’ loop with the /L parameter for moving through ranges is used to iterate through the array.</p></li>
</ul>
<h3>Output</h3>
<p>The above command produces the following output.</p>
<pre class="result notranslate">
Comments 
variables 
Arrays 
Decision making 
Time and date 
Operators
</pre>
<h2>Length of an Array</h2>
<p>The length of an array is done by iterating over the list of values in the array since there is no direct function to determine the number of elements in an array.</p>
<pre class="prettyprint notranslate">
&commat;echo off 
set Arr[0] = 1 
set Arr[1] = 2 
set Arr[2] = 3 
set Arr[3] = 4 
set "x = 0" 
:SymLoop 

if defined Arr[%x%] ( 
   call echo %%Arr[%x%]%% 
   set /a "x&plus;=1"
   GOTO :SymLoop 
)
echo "The length of the array is" %x%
</pre>
<h3>Output</h3>
<p>Output The above command produces the following output.</p>
<pre class="result notranslate">
The length of the array is 4
</pre>
<h2>Creating Structures in Arrays</h2>
<p>Structures can also be implemented in batch files using a little bit of an extra coding for implementation. The following example shows how this can be achieved.</p>
<h3>Example</h3>
<pre class="prettyprint notranslate">
&commat;echo off 
set len = 3 
set obj[0].Name = Joe 
set obj[0].ID = 1 
set obj[1].Name = Mark 
set obj[1].ID = 2 
set obj[2].Name = Mohan 
set obj[2].ID = 3 
set i = 0 
:loop 

if %i% equ %len% goto :eof 
set cur.Name= 
set cur.ID=

for /f "usebackq delims==.tokens=1-3" %%j in (`set obj[%i%]`) do ( 
   set cur.%%k=%%l 
) 
echo Name = %cur.Name% 
echo Value = %cur.ID% 
set /a i = %i%+1 
goto loop
</pre>
<p>The following key things need to be noted about the above code.</p>
<ul class="list">
<li><p>Each variable defined using the set command has 2 values associated with each index of the array.</p></li>
<li><p>The variable <b>i</b> is set to 0 so that we can loop through the structure will the length of the array which is 3.</p></li>
<li><p>We always check for the condition on whether the value of i is equal to the value of <b>len</b> and if not, we loop through the code.</p></li>
<li><p>We are able to access each element of the structure using the obj[%i%] notation.</p></li>
</ul>
<h3>Output</h3>
<p>The above command produces the following output.</p>
<pre class="result notranslate">
Name = Joe 
Value = 1 
Name = Mark 
Value = 2 
Name = Mohan 
Value = 3
</pre>
<h1>Batch Script - Decision Making</h1>
<p>Decision-making structures require that the programmer specify one or more conditions to be evaluated or tested by the program, along with a statement or statements to be executed if the condition is determined to be <b>true</b>, and optionally, other statements to be executed if the condition is determined to be <b>false</b>.</p>
<table class="table table-bordered">
<tr>
<th>S.No</th>
<th style="text-align:center;">Strings &amp; Description</th>
</tr>
<tr>
<td class="ts">1</td>
<td><a href="/batch_script/batch_script_if_statement.htm">If Statement</a>
<p>The first decision-making statement is the ‘if’ statement.</p></td>
</tr>
<tr>
<td class="ts">2</td>
<td><a href="/batch_script/batch_script_if_else_statement.htm">If/else Statement</a>
<p>The next decision making statement is the If/else statement. Following is the general form of this statement.</p></td>
</tr>
<tr>
<td class="ts">3</td>
<td><a href="/batch_script/batch_script_nested_if_statements.htm">Nested If Statements</a>
<p>Sometimes, there is a requirement to have multiple ‘if’ statement embedded inside each other. Following is the general form of this statement.</p></td>
</tr>
</table>
<h1>Batch Script - Operators</h1>
<p>An operator is a symbol that tells the compiler to perform specific mathematical or logical manipulations.</p>
<p>In batch script, the following types of operators are possible.</p>
<ul class="list">
<li>Arithmetic operators</li>
<li>Relational operators</li>
<li>Logical operators</li>
<li>Assignment operators</li>
<li>Bitwise operators</li>
</ul>
<h2>Arithmetic Operators</h2>
<p>Batch script language supports the normal Arithmetic operators as any language. Following are the Arithmetic operators available.</p>
<p><a href="/batch_script/batch_script_arithmetic_operators.htm">Show Example</a></p>
<table class="table table-bordered">
<tr>
<th style="text-align:center;">Operator</th>
<th style="text-align:center;">Description</th>
<th style="width:25%;text-align:center;">Example</th>
</tr>
<tr>
<td style="text-align:center;">&plus;</td>
<td>Addition of two operands</td>
<td>1 &plus; 2 will give 3</td>
</tr>
<tr>
<td style="text-align:center;">−</td>
<td>Subtracts second operand from the first</td>
<td>2 − 1 will give 1</td>
</tr>
<tr>
<td style="text-align:center;">*</td>
<td>Multiplication of both operands</td>
<td>2 * 2 will give 4</td>
</tr>
<tr>
<td style="text-align:center;">/</td>
<td>Division of the numerator by the denominator</td>
<td>3 / 2 will give 1.5</td>
</tr>
<tr>
<td style="text-align:center;">%</td>
<td>Modulus operator and remainder of after an integer/float division</td>
<td>3 % 2 will give 1</td>
</tr>
</table>
<h2>Relational Operators</h2>
<p>Relational operators allow of the comparison of objects. Below are the relational operators available.</p>
<p><a href="/batch_script/batch_script_relational_operators.htm">Show Example</a></p>
<table class="table table-bordered">
<tr>
<th style="text-align:center;">Operator</th>
<th style="text-align:center;">Description</th>
<th style="width:30%;text-align:center;">Example</th>
</tr>
<tr>
<td style="text-align:center;">EQU</td>
<td>Tests the equality between two objects</td>
<td>2 EQU 2 will give true</td>
</tr>
<tr>
<td style="text-align:center;">NEQ</td>
<td>Tests the difference between two objects</td>
<td>3 NEQ 2 will give true</td>
</tr>
<tr>
<td style="text-align:center;">LSS</td>
<td>Checks to see if the left object is less than the right operand</td>
<td>2 LSS 3 will give true</td>
</tr>
<tr>
<td style="text-align:center;">LEQ</td>
<td>Checks to see if the left object is less than or equal to the right operand</td>
<td>2 LEQ 3 will give true</td>
</tr>
<tr>
<td style="text-align:center;">GTR</td>
<td>Checks to see if the left object is greater than the right operand</td>
<td>3 GTR 2 will give true</td>
</tr>
<tr>
<td style="text-align:center;">GEQ</td>
<td>Checks to see if the left object is greater than or equal to the right operand</td>
<td>3 GEQ 2 will give true</td>
</tr>
</table>
<h2>Logical Operators</h2>
<p>Logical operators are used to evaluate Boolean expressions. Following are the logical operators available.</p>
<p>The batch language is equipped with a full set of Boolean logic operators like AND, OR, XOR, but only for binary numbers. Neither are there any values for TRUE or FALSE. The only logical operator available for conditions is the NOT operator.</p>
<p><a href="/batch_script/batch_script_logical_operators.htm">Show Example</a></p>
<table class="table table-bordered">
<tr>
<th style="text-align:center;">Operator</th>
<th style="text-align:center;">Description</th>
</tr>
<tr>
<td style="text-align:center;">AND</td>
<td>This is the logical “and” operator</td>
</tr>
<tr>
<td style="text-align:center;">OR</td>
<td>This is the logical “or” operator</td>
</tr>
<tr>
<td style="text-align:center;">NOT</td>
<td>This is the logical “not” operator</td>
</tr>
</table>
<h2>Assignment Operators</h2>
<p>Batch Script language also provides assignment operators. Following are the assignment operators available.</p>
<p><a href="/batch_script/batch_script_assignment_operators.htm">Show Example</a></p>
<table class="table table-bordered">
<tr>
<th style="width:10%;text-align:center;">Operator</th>
<th style="width:55%;text-align:center;">Description</th>
<th style="width:35%;text-align:center;">Example</th>
</tr>
<tr>
<td style="text-align:center;vertical-align:middle;">&plus;=</td>
<td>This adds right operand to the left operand and assigns the result to left operand</td>
<td>
<p>Set /A a = 5</p>
<p>a &plus;= 3</p>
<p>Output will be 8</p>
</td>
</tr>
<tr>
<td style="text-align:center;vertical-align:middle;">-=</td>
<td>This subtracts the right operand from the left operand and assigns the result to the left operand</td>
<td>
<p>Set /A a = 5</p>
<p>a -= 3</p>
<p>Output will be 2</p>
</td>
</tr>
<tr>
<td style="text-align:center;vertical-align:middle;">*=</td>
<td>This multiplies the right operand with the left operand and assigns the result to the left operand</td>
<td>
<p>Set /A a = 5</p>
<p>a *= 3</p>
<p>Output will be 15</p>
</td>
</tr>
<tr>
<td style="text-align:center;vertical-align:middle;">/=</td>
<td>This divides the left operand with the right operand and assigns the result to the left operand</td>
<td>
<p>Set /A a = 6</p>
<p>a/ = 3</p>
<p>Output will be 2</p>
</td>
</tr>
<tr>
<td style="text-align:center;vertical-align:middle;">%=</td>
<td>This takes modulus using two operands and assigns the result to the left operand</td>
<td>
<p>Set /A a = 5</p>
<p>a% = 3</p>
<p>Output will be 2</p>
</td>
</tr>
</table>
<h2>Bitwise Operators</h2>
<p>Bitwise operators are also possible in batch script. Following are the operators available.</p>
<p><a href="/batch_script/batch_script_bitwise_operators.htm">Show Example</a></p>
<table class="table table-bordered">
<tr>
<th style="text-align:center;">Operator</th>
<th style="text-align:center;">Description</th>
</tr>
<tr>
<td style="text-align:center;">&amp;</td>
<td>This is the bitwise “and” operator</td>
</tr>
<tr>
<td style="text-align:center;">|</td>
<td>This is the bitwise “or” operator</td>
</tr>
<tr>
<td style="text-align:center;">^</td>
<td>This is the bitwise “xor” or Exclusive or operator</td>
</tr>
</table>
<p>Following is the truth table showcasing these operators.</p>
<table class="table table-bordered"  style="text-align:center;" >
<tr>
<th style="text-align:center;" >p</th>
<th style="text-align:center;">q</th>
<th style="text-align:center;">p &amp; q</th>
<th style="text-align:center;">p | q</th>
<th style="text-align:center;">p ^ q</th>
</tr>
<tr>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
</table>
<h1>Batch Script - DATE and TIME</h1>
<p>The date and time in DOS Scripting have the following two basic commands for retrieving the date and time of the system.</p>
<h2>DATE</h2>
<p>This command gets the system date.</p>
<h3>Syntax</h3>
<pre class="result notranslate">
DATE
</pre>
<h3>Example</h3>
<pre class="prettyprint notranslate">
&commat;echo off 
echo %DATE%
</pre>
<h3>Output</h3>
<p>The current date will be displayed in the command prompt. For example,</p>
<pre class="result notranslate">
Mon 12/28/2015
</pre>
<h2>TIME</h2>
<p>This command sets or displays the time.</p>
<h3>Syntax</h3>
<pre class="result notranslate">
TIME
</pre>
<h3>Example</h3>
<pre class="prettyprint notranslate">
&commat;echo off 
echo %TIME%
</pre>
<h3>Output</h3>
<p>The current system time will be displayed. For example,</p>
<pre class="result notranslate">
22:06:52.87
</pre>
<p>Following are some implementations which can be used to get the date and time in different formats.</p>
<h2>Date in Format Year-Month-Day</h2>
<h3>Example</h3>
<pre class="prettyprint notranslate">
&commat;echo off 
echo/Today is: %year%-%month%-%day% 
goto :EOF 
setlocal ENABLEEXTENSIONS 
set t = 2&amp;if "%date%z" LSS "A" set t = 1 

for /f "skip=1 tokens = 2-4 delims = (-)" %%a in ('echo/^|date') do ( 
   for /f "tokens = %t%-4 delims=.-/ " %%d in ('date/t') do ( 
      set %%a=%%d&amp;set %%b=%%e&amp;set %%c=%%f)) 
endlocal&amp;set %1=%yy%&amp;set %2=%mm%&amp;set %3=%dd%&amp;goto :EOF
</pre>
<h3>Output</h3>
<p>The above command produces the following output.</p>
<pre class="result notranslate">
Today is: 2015-12-30
</pre>
<h1>Batch Script - Input / Output</h1>
<p>There are three universal “files” for keyboard input, printing text on the screen and printing errors on the screen. The “Standard In” file, known as <b>stdin</b>, contains the input to the program/script. The “Standard Out” file, known as <b>stdout</b>, is used to write output for display on the screen. Finally, the “Standard Err” file, known as <b>stderr</b>, contains any error messages for display on the screen.</p>
<p>Each of these three standard files, otherwise known as the standard streams, are referenced using the numbers 0, 1, and 2. Stdin is file 0, stdout is file 1, and stderr is file 2.</p>
<h2>Redirecting Output (Stdout and Stderr)</h2>
<p>One common practice in batch files is sending the output of a program to a log file. The &gt; operator sends, or redirects, stdout or stderr to another file. The following example shows how this can be done.</p>
<pre class="result notranslate">
Dir C:\ &gt; list.txt
</pre>
<p>In the above example, the <b>stdout</b> of the command Dir C:\ is redirected to the file list.txt.</p>
<p>If you append the number 2 to the redirection filter, then it would redirect the <b>stderr</b> to the file lists.txt.</p>
<pre class="result notranslate">
Dir C:\ 2&gt; list.txt
</pre>
<p>One can even combine the <b>stdout</b> and <b>stderr</b> streams using the file number and the ‘&amp;’ prefix. Following is an example.</p>
<pre class="result notranslate">
DIR C:\ &gt; lists.txt 2&gt;&amp;1
</pre>
<h2>Suppressing Program Output</h2>
<p>The pseudo file NUL is used to discard any output from a program. The following example shows that the output of the command DIR is discarded by sending the output to NUL.</p>
<pre class="result notranslate">
Dir C:\ &gt; NUL
</pre>
<h3>Stdin</h3>
<p>To work with the Stdin, you have to use a workaround to achieve this. This can be done by redirecting the command prompt’s own stdin, called CON.</p>
<p>The following example shows how you can redirect the output to a file called lists.txt. After you execute the below command, the command prompt will take all the input entered by user till it gets an EOF character. Later, it sends all the input to the file lists.txt.</p>
<pre class="result notranslate">
TYPE CON &gt; lists.txt
</pre>
<h1>Batch Script - Return Code</h1>
<p>By default when a command line execution is completed it should either return zero when execution succeeds or non-zero when execution fails. When a batch script returns a non-zero value after the execution fails, the non-zero value will indicate what is the error number. We will then use the error number to determine what the error is about and resolve it accordingly.</p>
<p>Following are the common exit code and their description.</p>
<table class="table table-bordered">
<tr>
<th>Error Code</th>
<th style="text-align:center;">Description</th>
</tr>
<tr>
<td style="text-align:center;">0</td>
<td>Program successfully completed.</td>
</tr>
<tr>
<td style="text-align:center;">1</td>
<td>Incorrect function. Indicates that Action has attempted to execute non-recognized command in Windows command prompt cmd.exe.</td>
</tr>
<tr>
<td style="text-align:center;">2</td>
<td>The system cannot find the file specified. Indicates that the file cannot be found in specified location.</td>
</tr>
<tr>
<td style="text-align:center;">3</td>
<td>The system cannot find the path specified. Indicates that the specified path cannot be found.</td>
</tr>
<tr>
<td style="text-align:center;">5</td>
<td>Access is denied. Indicates that user has no access right to specified resource.</td>
</tr>
<tr>
<td>
<p style="text-align:center;">9009</p>
<p style="text-align:center;">0x2331</p>
</td>
<td>Program is not recognized as an internal or external command, operable program or batch file. Indicates that command, application name or path has been misspelled when configuring the Action.</td>
</tr>
<tr>
<td>
<p style="text-align:center;">221225495</p>
<p style="text-align:center;">0xC0000017</p>
<p style="text-align:center;">-1073741801</p>
</td>
<td>
<p>Not enough virtual memory is available.</p>
<p>It indicates that Windows has run out of memory.</p>
</td>
</tr>
<tr>
<td>
<p style="text-align:center;">3221225786</p>
<p style="text-align:center;">0xC000013A</p>
<p style="text-align:center;">-1073741510</p>
</td>
<td>The application terminated as a result of a CTRL+C. Indicates that the application has been terminated either by the user's keyboard input CTRL+C or CTRL+Break or closing command prompt window.</td>
</tr>
<tr>
<td>
<p style="text-align:center;">3221225794</p>
<p style="text-align:center;">0xC0000142</p>
<p style="text-align:center;">-1073741502</p>
</td>
<td>The application failed to initialize properly. Indicates that the application has been launched on a Desktop to which the current user has no access rights. Another possible cause is that either gdi32.dll or user32.dll has failed to initialize.</td>
</tr>
</table>
<h2>Error Level</h2>
<p>The environmental variable %ERRORLEVEL% contains the return code of the last executed program or script.</p>
<p>By default, the way to check for the ERRORLEVEL is via the following code.</p>
<h3>Syntax</h3>
<pre class="result notranslate">
IF %ERRORLEVEL% NEQ 0 ( 
   DO_Something 
)
</pre>
<p>It is common to use the command EXIT /B %ERRORLEVEL% at the end of the batch file to return the error codes from the batch file.</p>
<p>EXIT /B at the end of the batch file will stop execution of a batch file.</p>
<p>Use EXIT /B &lt; exitcodes &gt; at the end of the batch file to return custom return codes.</p>
<p>Environment variable %ERRORLEVEL% contains the latest errorlevel in the batch file, which is the latest error codes from the last command executed. In the batch file, it is always a good practice to use environment variables instead of constant values, since the same variable get expanded to different values on different computers.</p>
<p>Let’s look at a quick example on how to check for error codes from a batch file.</p>
<h3>Example</h3>
<p>Let’s assume we have a batch file called Find.cmd which has the following code. In the code, we have clearly mentioned that we if don’t find the file called lists.txt then we should set the errorlevel to 7. Similarly, if we see that the variable userprofile is not defined then we should set the errorlevel code to 9.</p>
<pre class="prettyprint notranslate">
if not exist c:\lists.txt exit 7 
if not defined userprofile exit 9 
exit 0
</pre>
<p>Let’s assume we have another file called App.cmd that calls Find.cmd first. Now, if the Find.cmd returns an error wherein it sets the errorlevel to greater than 0 then it would exit the program. In the following batch file, after calling the Find.cnd find, it actually checks to see if the errorlevel is greater than 0.</p>
<pre class="prettyprint notranslate">
Call Find.cmd

if errorlevel gtr 0 exit 
echo “Successful completion”
</pre>
<h3>Output</h3>
<p>In the above program, we can have the following scenarios as the output &minus;</p>
<ul class="list">
<li><p>If the file c:\lists.txt does not exist, then nothing will be displayed in the console output.</p></li>
<li><p>If the variable userprofile does not exist, then nothing will be displayed in the console output.</p></li>
<li><p>If both of the above condition passes then the string “Successful completion” will be displayed in the command prompt.</p></li>
</ul>
<h2>Loops</h2>
<p>In the decision making chapter, we have seen statements which have been executed one after the other in a sequential manner. Additionally, implementations can also be done in Batch Script to alter the flow of control in a program’s logic. They are then classified into flow of control statements.</p>
<table class="table table-bordered">
<tr>
<th>S.No</th>
<th style="text-align:center;">Loops &amp; Description</th>
</tr>
<tr>
<td class="ts">1</td>
<td><a href="/batch_script/batch_script_while_statement_implementation.htm">While Statement Implementation</a>
<p>There is no direct while statement available in Batch Script but we can do an implementation of this loop very easily by using the if statement and labels.</p>
</td>
</tr>
<tr>
<td class="ts">2</td>
<td><a href="/batch_script/batch_script_for_statement_implementations.htm">For Statement - List Implementations</a>
<p>The "FOR" construct offers looping capabilities for batch files. Following is the common construct of the ‘for’ statement for working with a list of values.</p>
</td>
</tr>
<tr>
<td class="ts">3</td>
<td><a href="/batch_script/batch_script_looping_through_ranges.htm">Looping through Ranges</a>
<p>The ‘for’ statement also has the ability to move through a range of values. Following is the general form of the statement.</p>
</td>
</tr>
<tr>
<td class="ts">4</td>
<td><a href="/batch_script/batch_script_classic_loop_implementationn.htm">Classic for Loop Implementation</a>
<p>Following is the classic ‘for’ statement which is available in most programming languages.</p>
</td>
</tr>
</table>
<h2>Looping through Command Line Arguments</h2>
<p>The ‘for’ statement can also be used for checking command line arguments. The following example shows how the ‘for’ statement can be used to loop through the command line arguments.</p>
<h3>Example</h3>
<pre class="prettyprint notranslate">
&commat;ECHO OFF 
:Loop 

IF "%1"=="" GOTO completed 
FOR %%F IN (%1) DO echo %%F 
SHIFT 
GOTO Loop 
:completed
</pre>
<h3>Output</h3>
<p>Let’s assume that our above code is stored in a file called Test.bat. The above command will produce the following output if the batch file passes the command line arguments of 1,2 and 3 as Test.bat 1 2 3.</p>
<pre class="result notranslate">
1 
2 
3
</pre>
<p></p>
<table class="table table-bordered">
<tr>
<th>S.No</th>
<th style="text-align:center;">Loops &amp; Description</th>
</tr>
<tr>
<td class="ts">1</td>
<td><a href="/batch_script/batch_script_break_statement_implementation.htm">Break Statement Implementation</a>
<p>The break statement is used to alter the flow of control inside loops within any programming language. The break statement is normally used in looping constructs and is used to cause immediate termination of the innermost enclosing loop.</p>
</td>
</tr>
</table>
<h1>Batch Script - Functions</h1>
<p>A function is a set of statements organized together to perform a specific task. In batch scripts, a similar approach is adopted to group logical statements together to form a function.</p>
<p>As like any other languages, functions in Batch Script follows the same procedure &minus;</p>
<ul class="list">
<li><p><b>Function Declaration</b> &minus; It tells the compiler about a function's name, return type, and parameters.</p></li>
<li><p><b>Function Definition</b> &minus; It provides the actual body of the function.</p></li>
</ul>
<h2>Function Definition</h2>
<p>In Batch Script, a function is defined by using the label statement. When a function is newly defined, it may take one or several values as input 'parameters' to the function, process the functions in the main body, and pass back the values to the functions as output 'return types'.</p>
<p>Every function has a function name, which describes the task that the function performs. To use a function, you "call" that function with its name and pass its input values (known as arguments) that matches the types of the function's parameters.</p>
<p>Following is the syntax of a simple function.</p>
<pre class="result notranslate">
:function_name 
Do_something 
EXIT /B 0
</pre>
<ul class="list">
<li><p>The function_name is the name given to the function which should have some meaning to match what the function actually does.</p></li>
<li><p>The EXIT statement is used to ensure that the function exits properly.</p></li>
</ul>
<p>Following is an example of a simple function.</p>
<h3>Example</h3>
<pre class="prettyprint notranslate">
:Display 
SET /A index=2 
echo The value of index is %index% 
EXIT /B 0
</pre>
<table class="table table-bordered">
<tr>
<th>S.No</th>
<th style="text-align:center;">Functions &amp; Description</th>
</tr>
<tr>
<td class="ts">1</td>
<td><a href="/batch_script/batch_script_calling_function.htm">Calling a Function</a>
<p>A function is called in Batch Script by using the call command.</p>
</td>
</tr>
<tr>
<td class="ts">2</td>
<td><a href="/batch_script/batch_script_functions_with_parameters.htm">Functions with Parameters</a>
<p>Functions can work with parameters by simply passing them when a call is made to the function.</p>
</td>
</tr>
<tr>
<td class="ts">3</td>
<td><a href="/batch_script/batch_script_functions_with_return_values.htm">Functions with Return Values</a>
<p>Functions can work with return values by simply passing variables names</p>
</td>
</tr>
<tr>
<td class="ts">4</td>
<td><a href="/batch_script/batch_script_local_variables_functions.htm">Local Variables in Functions</a>
<p>Local variables in functions can be used to avoid name conflicts and keep variable changes local to the function.</p>
</td>
</tr>
<tr>
<td class="ts">5</td>
<td><a href="/batch_script/batch_script_recursive_functions.htm">Recursive Functions</a>
<p>The ability to completely encapsulate the body of a function by keeping variable changes local to the function and invisible to the caller.</p>
</td>
</tr>
<tr>
<td class="ts">6</td>
<td><a href="/batch_script/batch_script_file_io.htm">File I/O</a>
<p>In Batch Script, it is possible to perform the normal file I/O operations that would be expected in any programming language.</p>
</td>
</tr>
<tr>
<td class="ts">7</td>
<td><a href="/batch_script/batch_script_creating_files.htm">Creating Files</a>
<p>The creation of a new file is done with the help of the redirection filter >. This filter can be used to redirect any output to a file.</p>
</td>
</tr>
<tr>
<td class="ts">8</td>
<td><a href="/batch_script/batch_script_writing_files.htm">Writing to Files</a>
<p>Content writing to files is also done with the help of the redirection filter >. This filter can be used to redirect any output to a file.</p>
</td>
</tr><tr>
<td class="ts">9</td>
<td><a href="/batch_script/batch_script_appending_files.htm">Appending to Files</a>
<p>Content writing to files is also done with the help of the double redirection filter &gt;&gt;. This filter can be used to append any output to a file.</p>
</td>
</tr>
<tr>
<td class="ts">10</td>
<td><a href="/batch_script/batch_script_reading_from_files.htm">Reading from Files</a>
<p>Reading of files in a batch script is done via using the FOR loop command to go through each line which is defined in the file that needs to be read.</p>
</td>
</tr>
<tr>
<td class="ts">11</td>
<td><a href="/batch_script/batch_script_deleting_files.htm">Deleting Files</a>
<p>For deleting files, Batch Script provides the DEL command.</p>
</td>
</tr>
<tr>
<td class="ts">12</td>
<td><a href="/batch_script/batch_script_renaming_files.htm">Renaming Files</a>
<p>For renaming files, Batch Script provides the REN or RENAME command.</p>
</td>
</tr>
<tr>
<td class="ts">13</td>
<td><a href="/batch_script/batch_script_moving_files.htm">Moving Files</a>
<p>For moving files, Batch Script provides the MOVE command.</p>
</td>
</tr>
<tr>
<td class="ts">14</td>
<td><a href="/batch_script/batch_script_files_pipes.htm">Batch Files – Pipes</a>
<p>The pipe operator (|) takes the output (by default, STDOUT) of one command and directs it into the input (by default, STDIN) of another command.</p>
</td>
</tr>
<tr>
<td class="ts">15</td>
<td><a href="/batch_script/batch_script_files_inputs.htm">Batch Files – Inputs</a>
<p>When a batch file is run, it gives you the option to pass in command line parameters which can then be read within the program for further processing.</p>
</td>
</tr>
<tr>
<td class="ts">16</td>
<td><a href="/batch_script/batch_script_using_shift_operator.htm">Using the SHIFT Operator</a>
<p>One of the limitations of command line arguments is that it can accept only arguments till %9. Let’s take an example of this limitation.</p>
</td>
</tr>
<tr>
<td class="ts">17</td>
<td><a href="/batch_script/batch_script_folders.htm">Folders</a>
<p>In Batch Script, it is possible to perform the normal folder based operations that would be expected in any programming language.</p>
</td>
</tr>
<tr>
<td class="ts">18</td>
<td><a href="/batch_script/batch_script_creating_folders.htm">Creating Folders</a>
<p>The creation of a folder is done with the assistance of the MD (Make directory) command.</p>
</td>
</tr>
<tr>
<td class="ts">19</td>
<td><a href="/batch_script/batch_script_listing_folder_contents.htm">Listing Folder Contents</a>
<p>The listing of folder contents can be done with the dir command. This command allows you to see the available files and directories in the current directory.</p>
</td>
</tr>
<tr>
<td class="ts">20</td>
<td><a href="/batch_script/batch_script_deleting_folders.htm">Deleting Folders</a>
<p>For deleting folders, Batch Scripting provides the DEL command.</p>
</td>
</tr>
<tr>
<td class="ts">21</td>
<td><a href="/batch_script/batch_script_renaming_folders.htm">Renaming Folders</a>
<p>For renaming folders, Batch Script provides the REN or RENAME command.</p>
</td>
</tr>
<tr>
<td class="ts">22</td>
<td><a href="/batch_script/batch_script_moving_folders.htm">Moving Folders</a>
<p>For moving folders, Batch Script provides the MOVE command.</p>
</td>
</tr>
</table>
<h1>Batch Script - Process</h1>
<p>In this chapter, we will discuss the various processes involved in Batch Script.</p>
<h2>Viewing the List of Running Processes</h2>
<p>In Batch Script, the TASKLIST command can be used to get the list of currently running processes within a system.</p>
<h3>Syntax</h3>
<pre class="result notranslate">
TASKLIST [/S system [/U username [/P [password]]]] [/M [module] | /SVC | /V] [/FI filter]
[/FO format] [/NH]
</pre>
<section class="toggle">
<label>Following are the description of the options which can be presented to the TASKLIST command.</label>
<div class="toggle-content">	
<table class="table table-bordered">
<tr>
<th>S.No.</th>
<th style="text-align:center;">Options &amp; Description</th>
</tr>
<tr>
<td class="ts">1.</td>
<td>
<p><b>/S system</b></p>
<p>Specifies the remote system to connect to</p>
</td>
</tr>
<tr>
<td class="ts">2.</td>
<td>
<p><b>/U</b></p>
<p><b>[domain\]user</b></p>
<p>Specifies the user context under which the command should execute.</p>
</td>
</tr>
<tr>
<td class="ts">3.</td>
<td>
<p><b>/P [password]</b></p>
<p>Specifies the password for the given user context. Prompts for input if omitted.</p>
</td>
</tr>
<tr>
<td class="ts">4.</td>
<td>
<p><b>/M [module]</b></p>
<p>Lists all tasks currently using the given exe/dll name. If the module name is not specified all loaded modules are displayed.</p>
</td>
</tr>
<tr>
<td class="ts">5.</td>
<td>
<p><b>/SVC</b></p>
<p>Displays services hosted in each process.</p>
</td>
</tr>
<tr>
<td class="ts">6.</td>
<td>
<p><b>/V</b></p>
<p>Displays verbose task information.</p>
</td>
</tr>
<tr>
<td class="ts">7.</td>
<td>
<p><b>/FI filter</b></p>
<p>Displays a set of tasks that match a given criteria specified by the filter.</p>
</td>
</tr>
<tr>
<td class="ts">8.</td>
<td>
<p><b>/FO format</b></p>
<p>Specifies the output format. Valid values: "TABLE", "LIST", "CSV".</p>
</td>
</tr>
<tr>
<td class="ts">9.</td>
<td>
<p><b>/NH</b></p>
<p>Specifies that the "Column Header" should not show in the output. Valid only for "TABLE" and "CSV" formats.</p>
</td>
</tr>
</table>
</div>
</section>
<h3>Examples</h3>
<pre class="result notranslate">
TASKLIST
</pre>
<p>The above command will get the list of all the processes running on your local system. Following is a snapshot of the output which is rendered when the above command is run as it is. As you can see from the following output, not only do you get the various processes running on your system, you also get the memory usage of each process.</p>
<pre class="result notranslate">
Image Name                    PID       Session Name       Session#     Mem Usage
========================= ========    ================ =========== ============
System Idle Process             0        Services            0              4 K
System                          4        Services            0            272 K
smss.exe                      344        Services            0          1,040 K
csrss.exe                     528        Services            0          3,892 K
csrss.exe                     612        Console             1         41,788 K
wininit.exe                   620        Services            0          3,528 K
winlogon.exe                  648        Console             1          5,884 K
services.exe                  712        Services            0          6,224 K
lsass.exe                     720        Services            0          9,712 K
svchost.exe                   788        Services            0         10,048 K
svchost.exe                   832        Services            0          7,696 K
dwm.exe                       916        Console             1        117,440 K
nvvsvc.exe                    932        Services            0          6,692 K
nvxdsync.exe                  968        Console             1         16,328 K
nvvsvc.exe                    976        Console             1         12,756 K
svchost.exe                  1012        Services            0         21,648 K
svchost.exe                   236        Services            0         33,864 K
svchost.exe                   480        Services            0         11,152 K
svchost.exe                  1028        Services            0         11,104 K
svchost.exe                  1048        Services            0         16,108 K
wlanext.exe                  1220        Services            0         12,560 K
conhost.exe                  1228        Services            0          2,588 K
svchost.exe                  1276        Services            0         13,888 K
svchost.exe                  1420        Services            0         13,488 K
spoolsv.exe                  1556        Services            0          9,340 K
</pre>
<p></p>
<pre class="result notranslate">
tasklist &gt; process.txt
</pre>
<p>The above command takes the output displayed by tasklist and saves it to the process.txt file.</p>
<pre class="result notranslate">
tasklist /fi "memusage gt 40000"
</pre>
<p>The above command will only fetch those processes whose memory is greater than 40MB. Following is a sample output that can be rendered.</p>
<pre class="result notranslate">
Image Name                    PID      Session Name     Session#     Mem Usage
=========================   ======== ================ =========== ============
dwm.exe                        916     Console             1        127,912 K
explorer.exe                  2904     Console             1        125,868 K
ServerManager.exe             1836     Console             1         59,796 K
WINWORD.EXE                   2456     Console             1        144,504 K
chrome.exe                    4892     Console             1        123,232 K
chrome.exe                    4976     Console             1         69,412 K
chrome.exe                    1724     Console             1         76,416 K
chrome.exe                    3992     Console             1         56,156 K
chrome.exe                    1168     Console             1        233,628 K
chrome.exe                     816     Console             1         66,808 K
</pre>
<h2>Killing a Particular Process</h2>
<p>Allows a user running Microsoft Windows XP professional, Windows 2003, or later to kill a task from a Windows command line by process id (PID) or image name. The command used for this purpose is the TASKILL command.</p>
<h3>Syntax</h3>
<pre class="result notranslate">
TASKKILL [/S system [/U username [/P [password]]]] { [/FI filter] 
[/PID processid | /IM imagename] } [/T] [/F]
</pre>
<section class="toggle">
<label>Following are the description of the options which can be presented to the TASKKILL command.</label>
<div class="toggle-content">
<table class="table table-bordered">
<tr>
<th>S.No.</th>
<th style="text-align:center;">Options &amp; Description</th>
</tr>
<tr>
<td class="ts">1.</td>
<td>
<p><b>/S system</b></p>
<p>Specifies the remote system to connect to</p>
</td>
</tr>
<tr>
<td class="ts">2.</td>
<td>
<p><b>/U</b></p>
<p><b>[domain\]user</b></p>
<p>Specifies the user context under which the command should execute.</p>
</td>
</tr>
<tr>
<td class="ts">3.</td>
<td>
<p><b>/P [password]</b></p>
<p>Specifies the password for the given user context. Prompts for input if omitted.</p>
</td>
</tr>
<tr>
<td class="ts">4.</td>
<td>
<p><b>/FI</b></p>
<p><b>FilterName</b></p>
<p>Applies a filter to select a set of tasks. Allows "*" to be used. ex. imagename eq acme* See below filters for additional information and examples.</p>
</td>
</tr>
<tr>
<td class="ts">5.</td>
<td>
<p><b>/PID</b></p>
<p><b>processID</b></p>
<p>Specifies the PID of the process to be terminated. Use TaskList to get the PID.</p>
</td>
</tr>
<tr>
<td class="ts">6.</td>
<td>
<p><b>/IM</b></p>
<p><b>ImageName</b></p>
<p>Specifies the image name of the process to be terminated. Wildcard '*' can be used to specify all tasks or image names.</p>
</td>
</tr>
<tr>
<td class="ts">7.</td>
<td>
<p><b>/T</b></p>
<p>Terminates the specified process and any child processes which were started by it.</p>
</td>
</tr>
<tr>
<td class="ts">8.</td>
<td>
<p><b>/F</b></p>
<p>Specifies to forcefully terminate the process(es).</p>
</td>
</tr>
</table>
</div>
</section>
<h3>Examples</h3>
<pre class="result notranslate">
taskkill /f /im notepad.exe
</pre>
<p>The above command kills the open notepad task, if open.</p>
<pre class="result notranslate">
taskill /pid 9214
</pre>
<p>The above command kills a process which has a process of 9214.</p>
<h2>Starting a New Process</h2>
<p>DOS scripting also has the availability to start a new process altogether. This is achieved by using the START command.</p>
<h3>Syntax</h3>
<pre class="result notranslate">
START "title" [/D path] [options] "command" [parameters]
</pre>
<p>Wherein</p>
<ul class="list">
<li><p><b>title</b> &minus; Text for the CMD window title bar (required.)</p></li>
<li><p><b>path</b> &minus; Starting directory.</p></li>
<li><p><b>command</b> &minus; The command, batch file or executable program to run.</p></li>
<li><p><b>parameters</b> &minus; The parameters passed to the command.</p></li>
</ul>
<section class="toggle">
<label>Following are the description of the options which can be presented to the START command.</label>
<div class="toggle-content">
<table class="table table-bordered">
<tr>
<th style="width:5%">S.No.</th>
<th style="text-align:center;">Options &amp; Description</th>
</tr>
<tr>
<td class="ts">1.</td>
<td>
<p><b>/MIN</b></p>
<p>Start window Minimized</p>
</td>
</tr>
<tr>
<td class="ts">2.</td>
<td>
<p><b>/MAX</b></p>
<p>Start window maximized.</p>
</td>
</tr>
<tr>
<td class="ts">3.</td>
<td>
<p><b>/LOW</b></p>
<p>Use IDLE priority class.</p>
</td>
</tr>
<tr>
<td class="ts">4.</td>
<td>
<p><b>/NORMAL</b></p>
<p>Use NORMAL priority class.</p>
</td>
</tr>
<tr>
<td class="ts">5.</td>
<td>
<p><b>/ABOVENORMAL</b></p>
<p>Use ABOVENORMAL priority class.</p>
</td>
</tr>
<tr>
<td class="ts">6.</td>
<td>
<p><b>/BELOWNORMAL</b></p>
<p>Use BELOWNORMAL priority class.</p>
</td>
</tr>
<tr>
<td class="ts">7.</td>
<td>
<p><b>/HIGH</b></p>
<p>Use HIGH priority class.</p>
</td>
</tr>
<tr>
<td class="ts">8.</td>
<td>
<p><b>/REALTIME</b></p>
<p>Use REALTIME priority class.</p>
</td>
</tr>
</table>
</div>
</section>
<h3>Examples</h3>
<pre class="result notranslate">
START "Test Batch Script" /Min test.bat
</pre>
<p>The above command will run the batch script test.bat in a new window. The windows will start in the minimized mode and also have the title of “Test Batch Script”.</p>
<pre class="result notranslate">
START "" "C:\Program Files\Microsoft Office\Winword.exe" "D:\test\TESTA.txt"
</pre>
<p>The above command will actually run Microsoft word in another process and then open the file TESTA.txt in MS Word.</p>
<h1>Batch Script - Aliases</h1>
<p>Aliases means creating shortcuts or keywords for existing commands. Suppose if we wanted to execute the below command which is nothing but the directory listing command with the /w option to not show all of the necessary details in a directory listing.</p>
<pre class="result notranslate">
Dir /w
</pre>
<p>Suppose if we were to create a shortcut to this command as follows.</p>
<pre class="result notranslate">
dw = dir /w
</pre>
<p>When we want to execute the <b>dir /w</b> command, we can simply type in the word <b>dw</b>. The word ‘dw’ has now become an alias to the command Dir /w.</p>
<h2>Creating an Alias</h2>
<p>Alias are managed by using the <b>doskey</b> command.</p>
<h3>Syntax</h3>
<pre class="result notranslate">
DOSKEY [options] [macroname=[text]]
</pre>
<p>Wherein</p>
<ul class="list">
<li><p><b>macroname</b> &minus; A short name for the macro.</p></li>
<li><p><b>text</b> &minus; The commands you want to recall.</p></li>
</ul>
<p>Following are the description of the options which can be presented to the DOSKEY command.</p>
<table class="table table-bordered">
<tr>
<th>S.No.</th>
<th style="text-align:center;">Options &amp; Description</th>
</tr>
<tr>
<td class="ts">1.</td>
<td>
<p><b>/REINSTALL</b></p>
<p>Installs a new copy of Doskey</p>
</td>
</tr>
<tr>
<td class="ts">2.</td>
<td>
<p><b>/LISTSIZE = size</b></p>
<p>Sets size of command history buffer.</p>
</td>
</tr>
<tr>
<td class="ts">3.</td>
<td>
<p><b>/MACROS</b></p>
<p>Displays all Doskey macros.</p>
</td>
</tr>
<tr>
<td class="ts">4.</td>
<td>
<p><b>/MACROS:ALL</b></p>
<p>Displays all Doskey macros for all executables which have Doskey macros.</p>
</td>
</tr>
<tr>
<td class="ts">5.</td>
<td>
<p><b>/MACROS:exename</b></p>
<p>Displays all Doskey macros for the given executable.</p>
</td>
</tr>
<tr>
<td class="ts">6.</td>
<td>
<p><b>/HISTORY</b></p>
<p>Displays all commands stored in memory.</p>
</td>
</tr>
<tr>
<td class="ts">7.</td>
<td>
<p><b>/INSERT</b></p>
<p>Specifies that new text you type is inserted in old text.</p>
</td>
</tr>
<tr>
<td class="ts">8.</td>
<td>
<p><b>/OVERSTRIKE</b></p>
<p>Specifies that new text overwrites old text.</p>
</td>
</tr>
<tr>
<td class="ts">9.</td>
<td>
<p><b>/EXENAME = exename</b></p>
<p>Specifies the executable.</p>
</td>
</tr>
<tr>
<td class="ts">10.</td>
<td>
<p><b>/MACROFILE = filename</b></p>
<p>Specifies a file of macros to install.</p>
</td>
</tr>
<tr>
<td class="ts">11.</td>
<td>
<p><b>macroname</b></p>
<p>Specifies a name for a macro you create.</p>
</td>
</tr>
<tr>
<td class="ts">12.</td>
<td>
<p><b>text</b></p>
<p>Specifies commands you want to record.</p>
</td>
</tr>
</table>
<h3>Example</h3>
<p>Create a new file called keys.bat and enter the following commands in the file. The below commands creates two aliases, one if for the cd command, which automatically goes to the directory called test. And the other is for the dir command.</p>
<pre class="result notranslate">
&commat;echo off
doskey cd = cd/test
doskey d = dir
</pre>
<p>Once you execute the command, you will able to run these aliases in the command prompt.</p>
<h3>Output</h3>
<p>The following screenshot shows that after the above created batch file is executed, you can freely enter the ‘d’ command and it will give you the directory listing which means that your alias has been created.</p>
<img src="/batch_script/images/alias_example_output.jpg" alt="Alias Example Output" />
<h2>Deleting an Alias</h2>
<p>An alias or macro can be deleted by setting the value of the macro to NULL.</p>
<h3>Example</h3>
<pre class="result notranslate">
&commat;echo off
doskey cd = cd/test
doskey d = dir
d= 
</pre>
<p>In the above example, we are first setting the macro d to d = dir. After which we are setting it to NULL. Because we have set the value of d to NULL, the macro d will deleted.</p>
<h2>Replacing an Alias</h2>
<p>An alias or macro can be replaced by setting the value of the macro to the new desired value.</p>
<h3>Example</h3>
<pre class="result notranslate">
&commat;echo off
doskey cd = cd/test
doskey d = dir

d = dir /w
</pre>
<p>In the above example, we are first setting the macro d to d = dir. After which we are setting it to dir /w. Since we have set the value of d to a new value, the alias ‘d’ will now take on the new value.</p>
<h1>Batch Script - Devices</h1>
<p>Windows now has an improved library which can be used in Batch Script for working with devices attached to the system. This is known as the device console – DevCon.exe.</p>
<p>Windows driver developers and testers can use DevCon to verify that a driver is installed and configured correctly, including the proper INF files, driver stack, driver files, and driver package. You can also use the DevCon commands (enable, disable, install, start, stop, and continue) in scripts to test the driver. <b>DevCon</b> is a command-line tool that performs device management functions on local computers and remote computers.</p>
<p>Display driver and device info DevCon can display the following properties of drivers and devices on local computers, and remote computers (running Windows XP and earlier) &minus;</p>
<ul class="list">
<li><p>Hardware IDs, compatible IDs, and device instance IDs. These identifiers are described in detail in device identification strings.</p></li>
<li><p>Device setup classes.</p></li>
<li><p>The devices in a device setup class.</p></li>
<li><p>INF files and device driver files.</p></li>
<li><p>Details of driver packages.</p></li>
<li><p>Hardware resources.</p></li>
<li><p>Device status.</p></li>
<li><p>Expected driver stack.</p></li>
<li><p>Third-party driver packages in the driver store.</p></li>
<li><p>Search for devices DevCon can search for installed and uninstalled devices on a local or remote computer by hardware ID, device instance ID, or device setup class.</p></li>
<li><p>Change device settings DevCon can change the status or configuration of Plug and Play (PnP) devices on the local computer in the following ways &minus;</p>
<ul class="list">
<li><p>Enable a device.</p></li>
<li><p>Disable a device.</p></li>
<li><p>Update drivers (interactive and non-interactive).</p></li>
<li><p>Install a device (create a devnode and install software).</p></li>
<li><p>Remove a device from the device tree and delete its device stack.</p></li>
<li><p>Rescan for Plug and Play devices.</p></li>
<li><p>Add, delete, and reorder the hardware IDs of root-enumerated devices.</p></li>
<li><p>Change the upper and lower filter drivers for a device setup class.</p></li>
<li><p>Add and delete third-party driver packages from the driver store.</p></li>
</ul>
</li>
</ul>
<p>DevCon (DevCon.exe) is included when you install the WDK, Visual Studio, and the Windows SDK for desktop apps. DevCon.exe kit is available in the following locations when installed.</p>
<pre class="result notranslate">
%WindowsSdkDir%\tools\x64\devcon.exe
%WindowsSdkDir%\tools\x86\devcon.exe
%WindowsSdkDir%\tools\arm\devcon.exe
</pre>
<h3>Syntax</h3>
<pre class="result notranslate">
devcon [/m:\\computer] [/r] command [arguments]
</pre>
<p>wherein</p>
<ul class="list">
<li><p><b>/m:\\computer</b> &minus; Runs the command on the specified remote computer. The backslashes are required.</p></li>
<li><p><b>/r</b> &minus; Conditional reboot. Reboots the system after completing an operation only if a reboot is required to make a change effective.</p></li>
<li><p><b>command</b> &minus; Specifies a DevCon command.</p></li>
<li><p>To list and display information about devices on the computer, use the following commands &minus;</p>
<ul class="list">
<li><p>DevCon HwIDs</p></li>
<li><p>DevCon Classes</p></li>
<li><p>DevCon ListClass</p></li>
<li><p>DevCon DriverFiles</p></li>
<li><p>DevCon DriverNodes</p></li>
<li><p>DevCon Resources</p></li>
<li><p>DevCon Stack</p></li>
<li><p>DevCon Status</p></li>
<li><p>DevCon Dp_enum</p></li>
</ul>
</li>
<li><p>To search for information about devices on the computer, use the following commands &minus;</p>
<ul class="list">
<li><p>DevCon Find</p></li>
<li><p>DevCon FindAll</p></li>
</ul>
</li>
<li><p>To manipulate the device or change its configuration, use the following commands &minus;</p>
<ul class="list">
<li><p>DevCon Enable</p></li>
<li><p>DevCon Disable</p></li>
<li><p>DevCon Update</p></li>
<li><p>DevCon UpdateNI</p></li>
<li><p>DevCon Install</p></li>
<li><p>DevCon Remove</p></li>
<li><p>DevCon Rescan</p></li>
<li><p>DevCon Restart</p></li>
<li><p>DevCon Reboot</p></li>
<li><p>DevCon SetHwID</p></li>
<li><p>DevCon ClassFilter</p></li>
<li><p>DevCon Dp_add</p></li>
<li><p>DevCon Dp_delete</p></li>
</ul>
</li>
</ul>
<h3>Examples</h3>
<p>Following are some examples on how the DevCon command is used.</p>
<pre class="result notranslate">
List all driver files
</pre>
<p>The following command uses the DevCon DriverFiles operation to list the file names of drivers that devices on the system use. The command uses the wildcard character (*) to indicate all devices on the system. Because the output is extensive, the command uses the redirection character (&gt;) to redirect the output to a reference file, driverfiles.txt.</p>
<pre class="result notranslate">
devcon driverfiles * &gt; driverfiles.txt
</pre>
<p>The following command uses the DevCon status operation to find the status of all devices on the local computer. It then saves the status in the status.txt file for logging or later review. The command uses the wildcard character (*) to represent all devices and the redirection character (&gt;) to redirect the output to the status.txt file.</p>
<pre class="result notranslate">
devcon status * &gt; status.txt
</pre>
<p>The following command enables all printer devices on the computer by specifying the Printer setup class in a DevCon Enable command. The command includes the /r parameter, which reboots the system if it is necessary to make the enabling effective.</p>
<pre class="result notranslate">
devcon /r enable = Printer
</pre>
<p>The following command uses the DevCon Install operation to install a keyboard device on the local computer. The command includes the full path to the INF file for the device (keyboard.inf) and a hardware ID (*PNP030b).</p>
<pre class="result notranslate">
devcon /r install c:\windows\inf\keyboard.inf *PNP030b
</pre>
<p>The following command will scan the computer for new devices.</p>
<pre class="result notranslate">
devcon scan
</pre>
<p>The following command will rescan the computer for new devices.</p>
<pre class="result notranslate">
devcon rescan
</pre>
<h1>Batch Script - Registry</h1>
<p>The Registry is one of the key elements on a windows system. It contains a lot of information on various aspects of the operating system. Almost all applications installed on a windows system interact with the registry in some form or the other.</p>
<p>The Registry contains two basic elements: keys and values. <b>Registry keys</b> are container objects similar to folders. <b>Registry values</b> are non-container objects similar to files. Keys may contain values or further keys. Keys are referenced with a syntax similar to Windows' path names, using backslashes to indicate levels of hierarchy.</p>
<p>This chapter looks at various functions such as querying values, adding, deleting and editing values from the registry.</p>
<table class="table table-bordered">
<tr>
<th>S.No</th>
<th style="text-align:center;">Types of Registry &amp; Description</th>
</tr>
<tr>
<td class="ts">1</td>
<td><a href="/batch_script/batch_script_reading_registry.htm">Reading from the Registry</a>
<p>Reading from the registry is done via the REG QUERY command.</p>
</td>
</tr>
<tr>
<td class="ts">2</td>
<td><a href="/batch_script/batch_script_adding_registry.htm">Adding to the Registry</a>
<p>Adding to the registry is done via the REG ADD command.</p>
</td>
</tr>
<tr>
<td class="ts">3</td>
<td><a href="/batch_script/batch_script_deleting_registry.htm">Deleting from the Registry</a>
<p>Deleting from the registry is done via the REG DEL command.</p>
</td>
</tr>
<tr>
<td class="ts">4</td>
<td><a href="/batch_script/batch_script_copying_registry_keys.htm">Copying Registry Keys</a>
<p>Copying from the registry is done via the REG COPY command.</p>
</td>
</tr>
<tr>
<td class="ts">5</td>
<td><a href="/batch_script/batch_script_comparing_registry_keys.htm">Comparing Registry Keys</a>
<p>Comparing registry keys is done via the REG COMPARE command.</p>
</td>
</tr>
</table>
<h1>Batch Script - Network</h1>
<p>Batch script has the facility to work with network settings. The NET command is used to update, fix, or view the network or network settings. This chapter looks at the different options available for the net command.</p>
<table class="table table-bordered">
<tr>
<th>S.No</th>
<th style="text-align:center;">NET Commands &amp; Description</th>
</tr>
<tr>
<td class="ts">1</td>
<td><a href="/batch_script/batch_script_net_accounts.htm">NET ACCOUNTS</a>
<p>View the current password &amp; logon restrictions for the computer.</p>
</td>
</tr>
<tr>
<td class="ts">2</td>
<td><a href="/batch_script/batch_script_net_config.htm">NET CONFIG</a>
<p>Displays your current server or workgroup settings.</p>
</td>
</tr>
<tr>
<td class="ts">3</td>
<td><a href="/batch_script/batch_script_net_computer.htm">NET COMPUTER</a>
<p>Adds or removes a computer attached to the windows domain controller.</p>
</td>
</tr>
<tr>
<td class="ts">4</td>
<td><a href="/batch_script/batch_script_net_user.htm">NET USER</a>
<p>This command can be used for the following</p>
<p>View the details of a particular user account.</p>
</td>
</tr>
<tr>
<td class="ts">5</td>
<td><a href="/batch_script/batch_script_net_stop_start.htm">NET STOP/START</a>
<p>This command is used to stop and start a particular service.</p>
</td>
</tr>
<tr>
<td class="ts">6</td>
<td><a href="/batch_script/batch_script_net_statistics.htm">NET STATISTICS</a>
<p>Display network statistics of the workstation or server.</p>
</td>
</tr>
<tr>
<td class="ts">7</td>
<td><a href="/batch_script/batch_script_net_use.htm">NET USE</a>
<p>Connects or disconnects your computer from a shared resource or displays information about your connections.</p>
</td>
</tr>
</table>
<h1>Batch Script - Printing</h1>
<p>Printing can also be controlled from within Batch Script via the NET PRINT command.</p>
<h3>Syntax</h3>
<pre class="result notranslate">
PRINT [/D:device] [[drive:][path]filename[...]]
</pre>
<p>Where /D:device - Specifies a print device.</p>
<h3>Example</h3>
<pre class="prettyprint notranslate">
print c:\example.txt /c /d:lpt1
</pre>
<p>The above command will print the example.txt file to the parallel port lpt1.</p>
<h2>Command Line Printer Control</h2>
<p>As of Windows 2000, many, but not all, printer settings can be configured from Windows's command line using PRINTUI.DLL and RUNDLL32.EXE</p>
<h3>Syntax</h3>
<pre class="result notranslate">
RUNDLL32.EXE PRINTUI.DLL,PrintUIEntry [ <i>options</i> ] [ &commat;<i>commandfile</i> ]
</pre>
<p>Where some of the options available are the following &minus;</p>
<ul class="list">
<li><p><b>/dl</b> &minus; Delete local printer.</p></li>
<li><p><b>/dn</b> &minus; Delete network printer connection.</p></li>
<li><p><b>/dd</b> &minus; Delete printer driver.</p></li>
<li><p><b>/e</b> &minus; Display printing preferences.</p></li>
<li><p><b>/f[file]</b> &minus; Either inf file or output file.</p></li>
<li><p><b>/F[file]</b> &minus; Location of an INF file that the INF file specified with /f may depend on.</p></li>
<li><p><b>/ia</b> &minus; Install printer driver using inf file.</p></li>
<li><p><b>/id</b> &minus; Install printer driver using add printer driver wizard.</p></li>
<li><p><b>/if</b> &minus; Install printer using inf file.</p></li>
<li><p><b>/ii</b> &minus; Install printer using add printer wizard with an inf file.</p></li>
<li><p><b>/il</b> &minus; Install printer using add printer wizard.</p></li>
<li><p><b>/in</b> &minus; Add network printer connection.</p></li>
<li><p><b>/ip</b> &minus; Install printer using network printer installation wizard.</p></li>
<li><p><b>/k</b> &minus; Print test page to specified printer, cannot be combined with command when installing a printer.</p></li>
<li><p><b>/l[path]</b> &minus; Printer driver source path.</p></li>
<li><p><b>/m[model]</b> &minus; Printer driver model name.</p></li>
<li><p><b>/n[name]</b> &minus; Printer name.</p></li>
<li><p><b>/o</b> &minus; Display printer queue view.</p></li>
<li><p><b>/p</b> &minus; Display printer properties.</p></li>
<li><p><b>/Ss</b> &minus; Store printer settings into a file.</p></li>
<li><p><b>/Sr</b> &minus; Restore printer settings from a file.</p></li>
<li><p><b>/y</b> &minus; Set printer as the default.</p></li>
<li><p><b>/Xg</b> &minus; Get printer settings.</p></li>
<li><p><b>/Xs</b> &minus; Set printer settings.</p></li>
</ul>
<h2>Testing if a Printer Exists</h2>
<p>There can be cases wherein you might be connected to a network printer instead of a local printer. In such cases, it is always beneficial to check if a printer exists in the first place before printing.</p>
<p>The existence of a printer can be evaluated with the help of the RUNDLL32.EXE PRINTUI.DLL which is used to control most of the printer settings.</p>
<h3>Example</h3>
<pre class="prettyprint notranslate">
SET PrinterName = Test Printer
SET file=%TEMP%\Prt.txt
RUNDLL32.EXE PRINTUI.DLL,PrintUIEntry /Xg /n "%PrinterName%" /f "%file%" /q

IF EXIST "%file%" (
   ECHO %PrinterName% printer exists
) ELSE (
   ECHO %PrinterName% printer does NOT exists
)
</pre>
<p>The above command will do the following &minus;</p>
<ul class="list">
<li><p>It will first set the printer name and set a file name which will hold the settings of the printer.</p></li>
<li><p>The RUNDLL32.EXE PRINTUI.DLL commands will be used to check if the printer actually exists by sending the configuration settings of the file to the file Prt.txt</p></li>
</ul>
<h1>Batch Script - Debugging</h1>
<p>Very often than not you can run into problems when running batch files and most often than not you would need to debug your batch files in some way or the other to determine the issue with the batch file itself. Following are some of the techniques that can help in debugging Batch Script files.</p>
<h2>Error Messages</h2>
<p>To discover the source of the message, follow these steps &minus;</p>
<p><b>Step 1</b> &minus; REM out the &commat;ECHO OFF line, i.e. REM &commat;ECHO OFF or :: &commat;ECHO OFF.</p>
<p><b>Step 2</b> &minus; Run the batch file with the required command line parameters, redirecting all output to a log file for later comparison.</p>
<pre class="result notranslate">
test.bat &gt; batch.log 2&gt;&amp;1
</pre>
<p><b>Step 3</b> &minus; Search the file batch.log for the error messages</p>
<p><b>Step 4</b> &minus; Check the previous line for any unexpected or invalid command, command line switch(es) or value(s); pay special attention to the values of any environment variables used in the command.</p>
<p><b>Step 5</b> &minus; Correct the error and repeat this process until all error messages have disappeared.</p>
<h2>Complex Command Lines</h2>
<p>Another common source of errors are incorrectly redirected commands, like for example "nested" FIND or FINDSTR commands with incorrect search strings, sometimes within a FOR /F loop.</p>
<p>To check the validity of these complex commands, follow these steps &minus;</p>
<p><b>Step 1</b> &minus; Insert "command check lines" just before a line which uses the complex command set.</p>
<p>Following is an example wherein the ECHO command is inserted to mark where the output of the first TYPE command ends and the next one starts.</p>
<pre class="result notranslate">
TYPE %Temp%.\apipaorg.reg
ECHO.================================================ TYPE %Temp%.\apipaorg.reg 
| FIND 
"[HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\TCPIP\Parameters\Interfaces\"
</pre>
<p><b>Step 2</b> &minus; Follow the procedure to find error message sources described above.</p>
<p><b>Step 3</b> &minus; Pay special attention to the output of the "simplified" command lines: Is the output of the expected format? Is the "token" value or position as expected?</p>
<h2>Subroutines</h2>
<p>Subroutines generating error messages pose an extra "challenge" in finding the cause of the error, as they may be called multiple times in the same batch file.</p>
<p>To help find out what causes the incorrect call to the subroutine, follow these steps &minus;</p>
<p><b>Step 1</b> &minus; Add and reset a counter variable at the beginning of the script &minus;</p>
<pre class="result notranslate">
SET Counter = 0
</pre>
<p><b>Step 2</b> &minus; Increment the counter each time the subroutine is called, by inserting the following line at the beginning of the subroutine</p>
<pre class="result notranslate">
SET /A Counter&plus;=1
</pre>
<p><b>Step 3</b> &minus; Insert another line right after the counter increment, containing only the SET command; this will list all environment variables and their values.</p>
<p><b>Step 4</b> &minus; Follow the procedure to find error message sources described above.</p>
<h2>Windows Versions</h2>
<p>If you intend to distribute your batch files to other computers that may or may not run the same Windows version, you will need to test your batch files in as many Windows versions as possible.</p>
<p>The following example shows how to check for various operating system versions to check the relevant windows versions.</p>
<pre class="prettyprint notranslate">
&commat;ECHO OFF
:: Check for Windows NT 4 and later

IF NOT "%OS%"=="Windows_NT" GOTO DontRun
:: Check for Windows NT 4
VER | FIND "Windows NT" &gt;NUL &amp;&amp; GOTO DontRun
:: Check for Windows 2000
VER | FIND "Windows 2000" &gt;NUL &amp;&amp; GOTO DontRun
:: Place actual code here . . .
:: End of actual code . . .
EXIT

:DontRun
ECHO Sorry, this batch file was written for Windows XP and later versions only
</pre>
<h1>Batch Script - Logging</h1>
<p>Logging in is possible in Batch Script by using the redirection command.</p>
<h2>Syntax</h2>
<pre class="result notranslate">
test.bat &gt; testlog.txt 2&gt; testerrors.txt
</pre>
<h2>Example</h2>
<p>Create a file called test.bat and enter the following command in the file.</p>
<pre class="result notranslate">
net statistics /Server
</pre>
<p>The above command has an error because the option to the net statistics command is given in the wrong way.</p>
<h2>Output</h2>
<p>If the command with the above test.bat file is run as</p>
<pre class="result notranslate">
test.bat &gt; testlog.txt 2&gt; testerrors.txt
</pre>
<p>And you open the file testerrors.txt, you will see the following error.</p>
<pre class="result notranslate">
The option /SERVER is unknown.
</pre>
<p>The syntax of this command is &minus;</p>
<pre class="result notranslate">
NET STATISTICS
[WORKSTATION | SERVER]
</pre>
<p>More help is available by typing NET HELPMSG 3506.</p>
<p>If you open the file called testlog.txt, it will show you a log of what commands were executed.</p>
<pre class="result notranslate">
C:\tp&gt;net statistics /Server
</pre>
<div class="mui-container-fluid button-borders show">
<div class="pre-btn">
<a href="/batch_script/batch_script_logging.htm"><i class="fal fa-chevron-circle-left"></i> Previous Page</a>
</div>
<div class="nxt-btn">
<a href="/batch_script/batch_script_useful_resources.htm">Next Page <i class="fal fa-chevron-circle-right"></i>&nbsp;</a>
</div>
</div>
<div class="google-bottom-ads">
<div>Advertisements</div>
<script><!--
var width = 580;
var height = 400;
var format = "580x400_as";
if( window.innerWidth < 468 ){
   width = 300;
   height = 250;
   format = "300x250_as";
}
google_ad_client = "pub-7133395778201029";
google_ad_width = width;
google_ad_height = height;
google_ad_format = format;
google_ad_type = "image";
google_ad_channel ="";
//--></script>
<script src="https://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<div class="space-bottom"></div>
</div>
</div>
<!-- Tutorial Content Ends Here -->
<!-- Right Column Starts Here -->
<div class="mui-col-md-2 google-right-ads">
<div class="space-top"></div>
<div class="google-right-ad" style="margin: 0px auto !important;margin-top:5px;">
<script><!--
google_ad_client = "pub-2537027957187252";
google_ad_width = 300;
google_ad_height = 250;
google_ad_format = "300x250_as";
google_ad_type = "image";
google_ad_channel ="";
//--></script>
<script src="https://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>
<div class="google-right-ad">
<div class="adsbyvli" data-ad-slot="vi_9012177"></div>
<script>(vitag.Init = window.vitag.Init || []).push(function(){viAPItag.display("vi_9012177")})</script>
</div>
<div class="space-bottom"></div>
<div class="google-right-ad">
<div class="adsbyvli" data-ad-slot="vi_9013289"></div>
<script>(vitag.Init = window.vitag.Init || []).push(function(){viAPItag.display("vi_9013289")})</script>
</div>
<div class="space-bottom" style="margin-bottom:15px;"></div>
</div>
<!-- Right Column Ends Here -->
</div>
</div>
<div class="clear"></div>
<footer id="footer">
<div class="mui--text-center">
<div class="mui--text-caption mui--text-light">
<a href="/index.htm" class="logo"><img class="img-responsive" src="/images/logo-black.png" alt="Tutorials Point" title="Tutorials Point"></a>
</div>
<ul class="mui-list--inline mui--text-body2 mui--text-light">
<li><a href="/about/index.htm"><i class="fal fa-globe"></i> About us</a></li>
<li><a href="/about/about_terms_of_use.htm"><i class="fal fa-asterisk"></i> Terms of use</a></li>
<li><a href="/about/about_privacy.htm#cookies"> <i class="fal fa-shield-check"></i> Cookies Policy</a></li>
<li><a href="/about/faq.htm"><i class="fal fa-question-circle"></i> FAQ's</a></li>
<li><a href="/about/about_helping.htm"><i class="fal fa-hands-helping"></i> Helping</a></li>
<li><a href="/about/contact_us.htm"><i class="fal fa-map-marker-alt"></i> Contact</a></li>
</ul>
<div class="mui--text-caption mui--text-light bottom-copyright-text">&copy; Copyright 2019. All Rights Reserved.</div>
</div>
<div id="privacy-banner">
  <div>
    <p>
      We use cookies to provide and improve our services. By using our site, you consent to our Cookies Policy.
      <a id="banner-accept" href="#">Accept</a>
      <a id="banner-learn" href="/about/about_cookies.htm" target="_blank">Learn more</a>
    </p>
  </div>
</div>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-232293-17"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-232293-6');
</script>
</footer>
</body>
</html>
